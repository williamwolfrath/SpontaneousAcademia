/**
 *  Copyright (c) 2010 Alethia Inc,
 *  http://www.alethia-inc.com
 *  Developed by Travis Tidwell | travist at alethia-inc.com 
 *
 *  License:  GPL version 3.
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the "Software"), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *  
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.

 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
(function(a){jQuery.media=jQuery.media?jQuery.media:{};jQuery.media=jQuery.extend({},{auto:function(b){return new (function(c){this.json=jQuery.media.json(c);this.rpc=jQuery.media.rpc(c);this.call=function(h,g,d,f,e){if(e=="json"){this.json.call(h,g,d,f,e);}else{this.rpc.call(h,g,d,f,e);}};})(b);}},jQuery.media);jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{volumeVertical:false});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{currentTime:"#mediacurrenttime",totalTime:"#mediatotaltime",playPause:"#mediaplaypause",seekUpdate:"#mediaseekupdate",seekProgress:"#mediaseekprogress",seekBar:"#mediaseekbar",seekHandle:"#mediaseekhandle",volumeUpdate:"#mediavolumeupdate",volumeBar:"#mediavolumebar",volumeHandle:"#mediavolumehandle",mute:"#mediamute"});jQuery.fn.mediacontrol=function(b){if(this.length===0){return null;}return new (function(e,c){c=jQuery.media.utils.getSettings(c);this.display=e;var f=this;this.formatTime=(c.template&&c.template.formatTime)?c.template.formatTime:function(j){j=j?j:0;var k=0;var h=0;var g=0;g=Math.floor(j/3600);j-=(g*3600);h=Math.floor(j/60);j-=(h*60);k=Math.floor(j%60);var i="";if(g){i+=String(g);i+=":";}i+=(h>=10)?String(h):("0"+String(h));i+=":";i+=(k>=10)?String(k):("0"+String(k));return{time:i,units:""};};this.setToggle=function(h,i){var g=i?".on":".off";var j=i?".off":".on";if(h){h.find(g).show();h.find(j).hide();}};var d=this.formatTime(0);this.duration=0;this.volume=-1;this.prevVolume=0;this.percentLoaded=0;this.playState=false;this.muteState=false;this.allowResize=true;this.currentTime=e.find(c.ids.currentTime).text(d.time);this.totalTime=e.find(c.ids.totalTime).text(d.time);this.display.find("a.mediaplayerlink").each(function(){var g=a(this).attr("href");a(this).medialink(c,function(h){h.preventDefault();f.display.trigger(h.data.id);},{id:g.substr(1),obj:a(this)});});this.playPauseButton=e.find(c.ids.playPause).medialink(c,function(g,h){f.playState=!f.playState;f.setToggle(h,f.playState);f.display.trigger("controlupdate",{type:(f.playState?"pause":"play")});});this.seekUpdate=e.find(c.ids.seekUpdate).css("width","0px");this.seekProgress=e.find(c.ids.seekProgress).css("width","0px");this.seekBar=e.find(c.ids.seekBar).mediaslider(c.ids.seekHandle,false);this.seekBar.display.bind("setvalue",function(g,h){f.updateSeek(h);f.display.trigger("controlupdate",{type:"seek",value:(h*f.duration)});});this.seekBar.display.bind("updatevalue",function(g,h){f.updateSeek(h);});this.updateSeek=function(g){this.seekUpdate.css("width",(g*this.seekBar.trackSize)+"px");this.currentTime.text(this.formatTime(g*this.duration).time);};this.setVolume=function(g){if(this.volumeBar){if(c.volumeVertical){this.volumeUpdate.css({marginTop:(this.volumeBar.handlePos+this.volumeBar.handleMid+this.volumeBar.handleOffset)+"px",height:(this.volumeBar.trackSize-this.volumeBar.handlePos)+"px"});}else{this.volumeUpdate.css("width",(g*this.volumeBar.trackSize)+"px");}}};this.volumeUpdate=e.find(c.ids.volumeUpdate);this.volumeBar=e.find(c.ids.volumeBar).mediaslider(c.ids.volumeHandle,c.volumeVertical,c.volumeVertical);if(this.volumeBar){this.volumeBar.display.bind("setvalue",function(g,h){f.setVolume(h);f.display.trigger("controlupdate",{type:"volume",value:h});});this.volumeBar.display.bind("updatevalue",function(g,h){f.setVolume(h);f.volume=h;});}this.mute=e.find(c.ids.mute).medialink(c,function(g,h){f.muteState=!f.muteState;f.setToggle(h,f.muteState);f.setMute(f.muteState);});this.setMute=function(g){this.prevVolume=(this.volumeBar.value>0)?this.volumeBar.value:this.prevVolume;this.volumeBar.updateValue(g?0:this.prevVolume);this.display.trigger("controlupdate",{type:"mute",value:g});};this.setProgress=function(g){if(this.seekProgress){this.seekProgress.css("width",(g*(this.seekBar.trackSize+this.seekBar.handleSize))+"px");}};this.onResize=function(h,g){if(this.allowResize){if(this.seekBar){this.seekBar.onResize(h,g);}this.setProgress(this.percentLoaded);}};this.onMediaUpdate=function(g){switch(g.type){case"paused":this.playState=true;this.setToggle(this.playPauseButton.display,this.playState);break;case"playing":this.playState=false;this.setToggle(this.playPauseButton.display,this.playState);break;case"stopped":this.playState=true;this.setToggle(this.playPauseButton.display,this.playState);break;case"progress":this.percentLoaded=g.percentLoaded;this.setProgress(this.percentLoaded);break;case"meta":case"update":this.timeUpdate(g.currentTime,g.totalTime);if(this.volumeBar){this.volumeBar.updateValue(g.volume);}break;default:break;}};this.reset=function(){this.totalTime.text(this.formatTime(0).time);if(this.seekBar){this.seekBar.updateValue(0);}};this.timeUpdate=function(g,h){this.duration=h;this.totalTime.text(this.formatTime(h).time);if(h&&!this.seekBar.dragging){this.seekBar.updateValue(g/h);}};this.timeUpdate(0,0);})(this,b);};window.onDailymotionPlayerReady=function(b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onReady();};jQuery.media.playerTypes=jQuery.extend(jQuery.media.playerTypes,{dailymotion:function(b){return(b.search(/^http(s)?\:\/\/(www\.)?dailymotion\.com/i)===0);}});jQuery.fn.mediadailymotion=function(c,b){return new (function(f,e,d){this.display=f;var g=this;this.player=null;this.videoFile=null;this.meta=false;this.loaded=false;this.ready=false;this.createMedia=function(i,k){this.videoFile=i;this.ready=false;var h=(e.id+"_media");var j=Math.floor(Math.random()*1000000);var l="http://www.dailymotion.com/swf/"+i.path+"?rand="+j+"&amp;enablejsapi=1&amp;playerapiid="+h;jQuery.media.utils.insertFlash(this.display,l,h,this.display.width(),this.display.height(),{},e.wmode,function(m){g.player=m;g.loadPlayer();});};this.loadMedia=function(h){if(this.player){this.loaded=false;this.meta=false;this.videoFile=h;d({type:"playerready"});this.player.loadVideoById(this.videoFile.path,0);}};this.onReady=function(){this.ready=true;this.loadPlayer();};this.loadPlayer=function(){if(this.ready&&this.player){window[e.id+"StateChange"]=function(h){g.onStateChange(h);};window[e.id+"PlayerError"]=function(h){g.onError(h);};this.player.addEventListener("onStateChange",e.id+"StateChange");this.player.addEventListener("onError",e.id+"PlayerError");d({type:"playerready"});this.player.loadVideoById(this.videoFile.path,0);}};this.onStateChange=function(i){var h=this.getPlayerState(i);if(!(!this.meta&&h=="stopped")){d({type:h});}if(!this.loaded&&h=="buffering"){this.loaded=true;d({type:"paused"});if(e.autostart){this.playMedia();}}if(!this.meta&&h=="playing"){this.meta=true;d({type:"meta"});}};this.onError=function(i){var h="An unknown error has occured: "+i;if(i==100){h="The requested video was not found.  ";h+="This occurs when a video has been removed (for any reason), ";h+="or it has been marked as private.";}else{if((i==101)||(i==150)){h="The video requested does not allow playback in an embedded player.";}}console.log(h);d({type:"error",data:h});};this.getPlayerState=function(h){switch(h){case 5:return"ready";case 3:return"buffering";case 2:return"paused";case 1:return"playing";case 0:return"complete";case -1:return"stopped";default:return"unknown";}return"unknown";};this.setSize=function(i,h){this.player.setSize(i,h);};this.playMedia=function(){d({type:"buffering"});this.player.playVideo();};this.pauseMedia=function(){this.player.pauseVideo();};this.stopMedia=function(){this.player.stopVideo();};this.seekMedia=function(h){d({type:"buffering"});this.player.seekTo(h,true);};this.setVolume=function(h){this.player.setVolume(h*100);};this.getVolume=function(){return(this.player.getVolume()/100);};this.getDuration=function(){return this.player.getDuration();};this.getCurrentTime=function(){return this.player.getCurrentTime();};this.getBytesLoaded=function(){return this.player.getVideoBytesLoaded();};this.getBytesTotal=function(){return this.player.getVideoBytesTotal();};this.getEmbedCode=function(){return this.player.getVideoEmbedCode();};this.getMediaLink=function(){return this.player.getVideoUrl();};this.hasControls=function(){return true;};this.showControls=function(h){};this.setQuality=function(h){};this.getQuality=function(){return"";};})(this,c,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{volume:80,autostart:false,streamer:"",embedWidth:450,embedHeight:337,wmode:"transparent",forceOverflow:false,quality:"default",repeat:false});jQuery.fn.mediadisplay=function(b){if(this.length===0){return null;}return new (function(d,c){this.settings=jQuery.media.utils.getSettings(c);this.display=d;var e=this;this.volume=0;this.player=null;this.preview="";this.reflowInterval=null;this.updateInterval=null;this.progressInterval=null;this.playQueue=[];this.playIndex=0;this.playerReady=false;this.loaded=false;this.mediaFile=null;this.width=0;this.height=0;if(this.settings.forceOverflow){this.display.parents().css("overflow","visible");}this.setSize=function(g,f){this.width=g?g:this.width;this.height=f?f:this.height;this.display.css({height:this.height+"px",width:this.width+"px"});if(this.playerReady&&this.width&&this.height){this.player.player.width=this.width;this.player.player.height=this.height;this.player.setSize(g,this.height);}};this.reset=function(){this.loaded=false;clearInterval(this.progressInterval);clearInterval(this.updateInterval);clearTimeout(this.reflowInterval);this.playQueue.length=0;this.playQueue=[];this.playIndex=0;this.playerReady=false;this.mediaFile=null;};this.resetContent=function(){this.display.empty();this.display.append(this.template);};this.getPlayableMedia=function(j){var h=null;var f=j.length;while(f--){var g=new jQuery.media.file(j[f],this.settings);if(!h||(g.weight<h.weight)){h=g;}}return h;};this.getMediaFile=function(f){if(f){var g=typeof f;if(((g==="object")||(g==="array"))&&f[0]){f=this.getPlayableMedia(f);}}return f;};this.addToQueue=function(f){if(f){this.playQueue.push(this.getMediaFile(f));}};this.loadFiles=function(f){if(f){this.playQueue.length=0;this.playQueue=[];this.playIndex=0;this.addToQueue(f.intro);this.addToQueue(f.commercial);this.addToQueue(f.prereel);this.addToQueue(f.media);this.addToQueue(f.postreel);}return(this.playQueue.length>0);};this.playNext=function(){if(this.playQueue.length>this.playIndex){this.loadMedia(this.playQueue[this.playIndex]);this.playIndex++;}else{if(this.settings.repeat){this.playIndex=0;this.playNext();}else{this.reset();}}};this.loadMedia=function(f){if(f){f=new jQuery.media.file(this.getMediaFile(f),this.settings);this.stopMedia();if(!this.mediaFile||(this.mediaFile.player!=f.player)){this.player=null;this.playerReady=false;if(f.player){this.player=this.display["media"+f.player](this.settings,function(g){e.onMediaUpdate(g);});}if(this.player){this.player.createMedia(f,this.preview);this.startReflow();}}else{if(this.player){this.player.loadMedia(f);}}this.mediaFile=f;this.onMediaUpdate({type:"initialize"});}};this.onMediaUpdate=function(g){switch(g.type){case"playerready":this.playerReady=true;clearTimeout(this.reflowInterval);this.player.setVolume(0);this.startProgress();break;case"buffering":this.startProgress();break;case"stopped":clearInterval(this.progressInterval);clearInterval(this.updateInterval);break;case"paused":clearInterval(this.updateInterval);break;case"playing":this.startUpdate();break;case"progress":var f=this.getPercentLoaded();jQuery.extend(g,{percentLoaded:f});if(f>=1){clearInterval(this.progressInterval);}break;case"update":case"meta":jQuery.extend(g,{currentTime:this.player.getCurrentTime(),totalTime:this.getDuration(),volume:this.player.getVolume(),quality:this.getQuality()});break;case"complete":this.playNext();break;}if(g.type=="playing"&&!this.loaded){this.loaded=true;this.player.setVolume((this.settings.volume/100));if(this.settings.autoLoad&&!this.settings.autostart){this.player.pauseMedia();this.settings.autostart=true;}else{this.display.trigger("mediaupdate",g);}}else{this.display.trigger("mediaupdate",g);}};this.reflowPlayer=function(){var f={marginLeft:parseInt(this.display.css("marginLeft"),10),height:this.display.css("height")};var g=(f.marginLeft>=0);this.display.css({marginLeft:(g?(f.marginLeft+1):0),height:(g?f.height:0)});setTimeout(function(){e.display.css(f);},1);};this.startReflow=function(){clearTimeout(this.reflowInterval);this.reflowInterval=setTimeout(function(){e.reflowPlayer();},2000);};this.startProgress=function(){if(this.playerReady){clearInterval(this.progressInterval);this.progressInterval=setInterval(function(){e.onMediaUpdate({type:"progress"});},500);}};this.startUpdate=function(){if(this.playerReady){clearInterval(this.updateInterval);this.updateInterval=setInterval(function(){if(e.playerReady){e.onMediaUpdate({type:"update"});}},1000);}};this.stopMedia=function(){this.loaded=false;clearInterval(this.progressInterval);clearInterval(this.updateInterval);clearTimeout(this.reflowInterval);if(this.playerReady){this.player.stopMedia();}};this.mute=function(f){if(f){this.volume=this.player.getVolume();this.player.setVolume(0);}else{this.player.setVolume(this.volume);}};this.getPercentLoaded=function(){var g=this.player.getBytesLoaded();var f=this.mediaFile.bytesTotal?this.mediaFile.bytesTotal:this.player.getBytesTotal();return f?(g/f):0;};this.showControls=function(f){if(this.playerReady){this.player.showControls(f);}};this.hasControls=function(){if(this.player){return this.player.hasControls();}return false;};this.getDuration=function(){if(!this.mediaFile.duration){this.mediaFile.duration=this.player.getDuration();}return this.mediaFile.duration;};this.getQuality=function(){if(!this.mediaFile.quality){this.mediaFile.quality=this.player.getQuality();}return this.mediaFile.quality;};this.setSize(this.display.width(),this.display.height());})(this,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{apiKey:"",api:2,sessid:"",drupalVersion:6});jQuery.media=jQuery.extend({},{drupal:function(c,b){return new (function(i,h){h=jQuery.media.utils.getSettings(h);var j=this;var e=(h.apiKey.length>0);var g=(h.api==1);var d=(h.drupalVersion>=6)?"node.get":"node.load";var f=(h.protocol=="auto");jQuery.media=jQuery.extend({},{commands:{connect:{command:{rpc:"system.connect",json:""},useKey:g,protocol:"rpc"},mail:{command:{rpc:"system.mail",json:""},useKey:e,protocol:"rpc"},loadNode:{command:{rpc:d,json:"mediafront_getnode"},useKey:g,protocol:"json"},getPlaylist:{command:{rpc:"mediafront.getPlaylist",json:"mediafront_getplaylist"},useKey:g,protocol:"json"},getVote:{command:{rpc:"vote.getVote",json:""},useKey:g,protocol:"rpc"},setVote:{command:{rpc:"vote.setVote",json:""},useKey:e,protocol:"rpc"},getUserVote:{command:{rpc:"vote.getUserVote",json:""},useKey:g,protocol:"rpc"},deleteVote:{command:{rpc:"vote.deleteVote",json:""},useKey:e,protocol:"rpc"},addTag:{command:{rpc:"tag.addTag",json:""},useKey:e,protocol:"rpc"},incrementCounter:{command:{rpc:"mediafront.incrementNodeCounter",json:""},useKey:e,protocol:"rpc"},setFavorite:{command:{rpc:"favorites.setFavorite",json:""},useKey:e,protocol:"rpc"},deleteFavorite:{command:{rpc:"favorites.deleteFavorite",json:""},useKey:e,protocol:"rpc"},isFavorite:{command:{rpc:"favorites.isFavorite",json:""},useKey:g,protocol:"rpc"},login:{command:{rpc:"user.login",json:""},useKey:e,protocol:"rpc"},logout:{command:{rpc:"user.logout",json:""},useKey:e,protocol:"rpc"},adClick:{command:{rpc:"mediafront.adClick",json:""},useKey:e,protocol:"rpc"},getAd:{command:{rpc:"mediafront.getAd",json:""},useKey:g,protocol:"rpc"},setUserStatus:{command:{rpc:"mediafront.setUserStatus",json:""},useKey:e,protocol:"rpc"}}},jQuery.media);this.user={};this.sessionId="";this.onConnected=null;this.encoder=new jQuery.media.sha256();this.baseURL=h.baseURL.substring(0,(h.baseURL.length-1)).replace(/^(http[s]?\:[\\\/][\\\/])/,"");this.connect=function(k){this.onConnected=k;if(h.sessid){this.onConnect({sessid:h.sessid});}else{this.call(jQuery.media.commands.connect,function(l){j.onConnect(l);},null);}};this.call=function(p,o,m){var k=[];for(var l=3;l<arguments.length;l++){k.push(arguments[l]);}k=this.setupArgs(p,k);var n=f?p.protocol:h.protocol;var q=p.command[n];if(q){i.call(q,o,m,k,n);}else{if(o){o(null);}}};this.setupArgs=function(o,k){k.unshift(this.sessionId);if(o.useKey){if(h.api>1){var m=this.getTimeStamp();var l=this.getNonce();var n=this.computeHMAC(m,this.baseURL,l,o.command.rpc,h.apiKey);k.unshift(l);k.unshift(m);k.unshift(this.baseURL);k.unshift(n);}else{k.unshift(h.apiKey);}}return k;};this.getTimeStamp=function(){return(parseInt(new Date().getTime()/1000,10)).toString();};this.getNonce=function(){var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var l="";for(var m=0;m<10;m++){var k=Math.floor(Math.random()*n.length);l+=n.substring(k,k+1);}return l;};this.computeHMAC=function(n,m,l,p,o){var k=n+";"+m+";"+l+";"+p;return this.encoder.encrypt(o,k);};this.onConnect=function(k){if(k){this.sessionId=k.sessid;this.user=k.user;}if(this.onConnected){this.onConnected(k);}};})(c,b);}},jQuery.media);jQuery.media.checkPlayType=function(c,b){if((typeof c.canPlayType)=="function"){return("no"!=c.canPlayType(b))&&(""!=c.canPlayType(b));}else{return false;}};jQuery.media.getPlayTypes=function(){var b={};var c=document.createElement("video");b.ogg=jQuery.media.checkPlayType(c,"video/ogg");b.h264=jQuery.media.checkPlayType(c,"video/mp4");b.webm=jQuery.media.checkPlayType(c,"video/x-webm");c=document.createElement("audio");b.audioOgg=jQuery.media.checkPlayType(c,"audio/ogg");b.mp3=jQuery.media.checkPlayType(c,"audio/mpeg");return b;};jQuery.media.playTypes=null;jQuery.media.file=function(b,c){if(!jQuery.media.playTypes){jQuery.media.playTypes=jQuery.media.getPlayTypes();}b=(typeof b==="string")?{path:b}:b;this.duration=b.duration?b.duration:0;this.bytesTotal=b.bytesTotal?b.bytesTotal:0;this.quality=b.quality?b.quality:0;this.stream=c.streamer?c.streamer:b.stream;this.path=b.path?jQuery.trim(b.path):(c.baseURL+jQuery.trim(b.filepath));this.extension=b.extension?b.extension:this.getFileExtension();this.weight=b.weight?b.weight:this.getWeight();this.player=b.player?b.player:this.getPlayer();this.mimetype=b.mimetype?b.mimetype:this.getMimeType();this.type=b.type?b.type:this.getType();};jQuery.media.file.prototype.getFileExtension=function(){return this.path.substring(this.path.lastIndexOf(".")+1).toLowerCase();};jQuery.media.file.prototype.getPlayer=function(){switch(this.extension){case"ogg":case"ogv":return jQuery.media.playTypes.ogg?"html5":"flash";case"mp4":case"m4v":return jQuery.media.playTypes.h264?"html5":"flash";case"webm":return jQuery.media.playTypes.webm?"html5":"flash";case"oga":return jQuery.media.playTypes.audioOgg?"html5":"flash";case"mp3":return jQuery.media.playTypes.mp3?"html5":"flash";case"swf":case"flv":case"f4v":case"f4a":case"mov":case"3g2":case"3gp":case"3gpp":case"m4a":case"aac":case"wav":case"aif":case"wma":return"flash";default:for(var b in jQuery.media.playerTypes){if(jQuery.media.playerTypes.hasOwnProperty(b)){if(jQuery.media.playerTypes[b](this.path)){return b;}}}}return"";};jQuery.media.file.prototype.getType=function(){switch(this.extension){case"swf":case"webm":case"ogg":case"ogv":case"mp4":case"m4v":case"flv":case"f4v":case"mov":case"3g2":case"3gp":case"3gpp":return"video";case"oga":case"mp3":case"f4a":case"m4a":case"aac":case"wav":case"aif":case"wma":return"audio";}};jQuery.media.file.prototype.getWeight=function(){switch(this.extension){case"mp4":case"m4v":case"m4a":return jQuery.media.playTypes.h264?3:7;case"webm":return jQuery.media.playTypes.webm?4:8;case"ogg":case"ogv":return jQuery.media.playTypes.ogg?5:20;case"oga":return jQuery.media.playTypes.audioOgg?5:20;case"mp3":return 6;case"mov":case"swf":case"flv":case"f4v":case"f4a":case"3g2":case"3gp":case"3gpp":return 9;case"wav":case"aif":case"aac":return 10;case"wma":return 11;}};jQuery.media.file.prototype.getMimeType=function(){switch(this.extension){case"mp4":case"m4v":case"flv":case"f4v":return"video/mp4";case"webm":return"video/x-webm";case"ogg":case"ogv":return"video/ogg";case"3g2":return"video/3gpp2";case"3gpp":case"3gp":return"video/3gpp";case"mov":return"video/quicktime";case"swf":return"application/x-shockwave-flash";case"oga":return"audio/ogg";case"mp3":return"audio/mpeg";case"m4a":case"f4a":return"audio/mp4";case"aac":return"audio/aac";case"wav":return"audio/vnd.wave";case"wma":return"audio/x-ms-wma";}};window.onFlashPlayerReady=function(b){jQuery.media.players[b].node.player.media.player.onReady();};window.onFlashPlayerUpdate=function(c,b){jQuery.media.players[c].node.player.media.player.onMediaUpdate(b);};window.onFlashPlayerDebug=function(b){console.log(b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{flashPlayer:"./flash/mediafront.swf",skin:"default",config:"nocontrols"});jQuery.fn.mediaflash=function(c,b){return new (function(f,e,d){e=jQuery.media.utils.getSettings(e);this.display=f;var g=this;this.player=null;this.videoFile=null;this.preview="";this.ready=false;this.translate={mediaConnected:"connected",mediaBuffering:"buffering",mediaPaused:"paused",mediaPlaying:"playing",mediaStopped:"stopped",mediaComplete:"complete",mediaMeta:"meta"};this.createMedia=function(j,l){this.videoFile=j;this.preview=l;this.ready=false;var i=(e.id+"_media");var k=Math.floor(Math.random()*1000000);var m=e.flashPlayer+"?rand="+k;var h={config:e.config,id:e.id,file:j.path,skin:e.skin,autostart:(e.autostart||!e.autoLoad)};if(j.stream){h.stream=j.stream;}if(e.debug){h.debug="1";}jQuery.media.utils.insertFlash(this.display,m,i,this.display.width(),this.display.height(),h,e.wmode,function(n){g.player=n;g.loadPlayer();});};this.loadMedia=function(h){if(this.player){this.videoFile=h;this.player.loadMedia(h.path,h.stream);d({type:"playerready"});}};this.onReady=function(){this.ready=true;this.loadPlayer();};this.loadPlayer=function(){if(this.ready&&this.player){d({type:"playerready"});}};this.onMediaUpdate=function(h){d({type:this.translate[h]});};this.playMedia=function(){this.player.playMedia();};this.pauseMedia=function(){this.player.pauseMedia();};this.stopMedia=function(){this.player.stopMedia();};this.seekMedia=function(h){this.player.seekMedia(h);};this.setVolume=function(h){this.player.setVolume(h);};this.getVolume=function(){return this.player.getVolume();};this.getDuration=function(){return this.player.getDuration();};this.getCurrentTime=function(){return this.player.getCurrentTime();};this.getBytesLoaded=function(){return this.player.getMediaBytesLoaded();};this.getBytesTotal=function(){return this.player.getMediaBytesTotal();};this.hasControls=function(){return true;};this.showControls=function(h){this.player.showPlugin("controlBar",h);this.player.showPlugin("playLoader",h);};this.getEmbedCode=function(){var h={config:"config",id:"mediafront_player",file:this.videoFile.path,image:this.preview,skin:e.skin};if(this.videoFile.stream){h.stream=this.videoFile.stream;}return jQuery.media.utils.getFlash(e.flashPlayer,"mediafront_player",e.embedWidth,e.embedHeight,h,e.wmode);};this.setQuality=function(h){};this.getQuality=function(){return"";};this.setSize=function(i,h){};this.getMediaLink=function(){return"This video currently does not have a link.";};})(this,c,b);};jQuery.fn.mediahtml5=function(c,b){return new (function(f,e,d){this.display=f;var g=this;this.player=null;this.bytesLoaded=0;this.bytesTotal=0;this.mediaType="";this.getPlayer=function(h,m){var j=e.id+"_"+this.mediaType;var l="<"+this.mediaType+' style="position:absolute" id="'+j+'"';l+=(this.mediaType=="video")?' width="'+this.display.width()+'px" height="'+this.display.height()+'px"':"";l+=m?' poster="'+m+'"':"";if(typeof h==="array"){l+=">";var k=h.length;while(k--){l+='<source src="'+h[k].path+'" type="'+h[k].mimetype+'">';}}else{l+=' src="'+h.path+'">Unable to display media.';}l+="</"+this.mediaType+">";this.display.append(l);return this.display.find("#"+j).eq(0)[0];};this.createMedia=function(h,i){jQuery.media.utils.removeFlash(this.display,e.id+"_media");this.display.children().remove();this.mediaType=this.getMediaType(h);this.player=this.getPlayer(h,i);this.player.addEventListener("abort",function(){d({type:"stopped"});},true);this.player.addEventListener("loadstart",function(){d({type:"ready"});},true);this.player.addEventListener("loadedmetadata",function(){d({type:"meta"});},true);this.player.addEventListener("ended",function(){d({type:"complete"});},true);this.player.addEventListener("pause",function(){d({type:"paused"});},true);this.player.addEventListener("play",function(){d({type:"playing"});},true);this.player.addEventListener("error",function(){d({type:"error"});},true);this.player.addEventListener("progress",function(j){g.bytesLoaded=j.loaded;g.bytesTotal=j.total;},true);this.player.autoplay=true;this.player.autobuffer=true;d({type:"playerready"});};this.loadMedia=function(h){this.createMedia(h);};this.getMediaType=function(h){var i=(typeof h==="array")?h[0].extension:h.extension;switch(i){case"ogg":case"ogv":case"mp4":case"m4v":return"video";case"oga":case"mp3":return"audio";}return"video";};this.playMedia=function(){this.player.play();};this.pauseMedia=function(){this.player.pause();};this.stopMedia=function(){this.pauseMedia();this.player.src="";};this.seekMedia=function(h){this.player.currentTime=h;};this.setVolume=function(h){this.player.volume=h;};this.getVolume=function(){return this.player.volume;};this.getDuration=function(){return this.player.duration;};this.getCurrentTime=function(){return this.player.currentTime;};this.getBytesLoaded=function(){return this.bytesLoaded;};this.getBytesTotal=function(){return this.bytesTotal;};this.setQuality=function(h){};this.getQuality=function(){return"";};this.hasControls=function(){return false;};this.showControls=function(h){};this.setSize=function(i,h){};this.getEmbedCode=function(){return"This media cannot be embedded.";};this.getMediaLink=function(){return"This media currently does not have a link.";};})(this,c,b);};jQuery.fn.mediaimage=function(c,b){if(this.length===0){return null;}return new (function(e,i,d){this.display=e;var j=this;var g=0;var f=false;this.width=this.display.width();this.height=this.display.height();this.imgLoader=new Image();this.imgLoader.onload=function(){f=true;g=(j.imgLoader.width/j.imgLoader.height);j.resize();j.display.trigger("imageLoaded");};var h=i?'<a target="_blank" href="'+i+'"><img src=""></img></a>':'<img src=""></img>';this.image=e.append(h).find("img");e.css("overflow","hidden");this.resize=function(m,k){this.width=d?this.imgLoader.width:(m?m:this.width?this.width:this.display.width());this.height=d?this.imgLoader.height:(k?k:this.height?this.height:this.display.height());if(this.width&&this.height&&f){this.display.css({width:this.width,height:this.height});var l=jQuery.media.utils.getScaledRect(g,{width:this.width,height:this.height});this.image.attr("src",this.imgLoader.src).css({marginLeft:l.x,marginTop:l.y,width:l.width+"px",height:l.height+"px"}).show();}};this.clear=function(){f=false;if(this.image){this.image.hide();this.image.attr("src","");}e.empty();};this.refresh=function(){this.resize();};this.loadImage=function(k){this.image.hide();this.imgLoader.src=k;};})(this,c,b);};jQuery.media=jQuery.extend({},{json:function(b){return new (function(e){var f=this;var c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var d={"boolean":function(g){return String(g);},"null":function(g){return"null";},number:function(g){return isFinite(g)?String(g):"null";},string:function(g){if(/["\\\x00-\x1f]/.test(g)){g=g.replace(/([\x00-\x1f\\"])/g,function(i,h){var j=c[h];if(j){return j;}j=h.charCodeAt();return"\\u00"+Math.floor(j/16).toString(16)+(j%16).toString(16);});}return'"'+g+'"';},array:function(h){var k=["["],g,o,n,j=h.length,m;for(n=0;n<j;n+=1){m=h[n];o=d[typeof m];if(o){m=o(m);if(typeof m=="string"){if(g){k[k.length]=",";}k[k.length]=m;g=true;}}}k[k.length]="]";return k.join("");},object:function(h){if(h){if(h instanceof Array){return d.array(h);}var j=["{"],g,m,l,k;for(l in h){if(h.hasOwnProperty(l)){k=h[l];m=d[typeof k];if(m){k=m(k);if(typeof k=="string"){if(g){j[j.length]=",";}j.push(d.string(l),":",k);g=true;}}}}j[j.length]="}";return j.join("");}return"null";}};this.serializeToJSON=function(g){return d.object(g);};this.call=function(k,j,g,i,h){if(e.baseURL){jQuery.ajax({url:e.baseURL+k,dataType:"json",type:"POST",data:{methodName:k,params:this.serializeToJSON(i)},error:function(l,n,m){if(g){g(n);}else{console.log("Error: "+n);}},success:function(l){if(j){j(l);}}});}else{if(j){j(null);}}};})(b);}},jQuery.media);jQuery.fn.medialink=function(b,d,c){c=c?c:{noargs:true};return new (function(f,e,h,g){var i=this;this.display=f;this.display.css("cursor","pointer").bind("click",g,function(j){h(j,a(this));}).bind("mouseenter",function(){if(e.template.onLinkOver){e.template.onLinkOver(a(this));}}).bind("mouseleave",function(){if(e.template.onLinkOut){e.template.onLinkOut(a(this));}});})(this,b,d,c);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{links:[],linksvertical:false});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{linkScroll:"#medialinkscroll"});jQuery.fn.medialinks=function(b){return new (function(c,d){d=jQuery.media.utils.getSettings(d);this.display=c;var e=this;this.previousLink=null;this.scrollRegion=c.find(d.ids.linkScroll).mediascroll({vertical:d.linksvertical});this.scrollRegion.clear();this.loadLinks=function(){if(c.length>0){this.scrollRegion.clear();var f=function(i,j){e.setLink(j);};var g=d.links.length;while(g--){var h=this.scrollRegion.newItem().playlistlink(d,d.links[g]);h.bind("linkclick",f);}this.scrollRegion.activate();}};this.setLink=function(f){if(this.previousLink){this.previousLink.setActive(false);}f.setActive(true);this.previousLink=f;};})(this,b);};jQuery.media.ids=jQuery.extend(jQuery.media.ids,{close:"#mediamenuclose",embed:"#mediaembed",elink:"#mediaelink",email:"#mediaemail"});jQuery.fn.mediamenu=function(c,b){if(this.length===0){return null;}return new (function(f,g,e){e=jQuery.media.utils.getSettings(e);var h=this;this.display=g;this.on=false;this.contents=[];this.prevItem={id:0,link:null,contents:null};this.close=this.display.find(e.ids.close);this.close.bind("click",function(){h.display.trigger("menuclose");});this.setMenuItem=function(j,k){if(this.prevItem.id!=k){if(this.prevItem.id){e.template.onMenuSelect(this.prevItem.link,this.prevItem.contents,false);}var i=this.contents[k];e.template.onMenuSelect(j,i,true);this.prevItem={id:k,link:j,contents:i};}};this.setEmbedCode=function(i){this.setInputItem(e.ids.embed,i);};this.setMediaLink=function(i){this.setInputItem(e.ids.elink,i);};this.setInputItem=function(k,j){var i=this.contents[k].find("input");i.unbind();i.bind("click",function(){a(this).select().focus();});i.attr("value",j);};var d=0;this.links=this.display.find("ul li");this.links.each(function(){var j=a(this).find("a");var k=j.attr("href");var i=h.display.find(k);i.hide();h.contents[k]=i;j.bind("mouseenter",a(this),function(l){e.template.onMenuOver(l.data);});j.bind("mouseleave",a(this),function(l){e.template.onMenuOut(l.data);});j.bind("click",{id:k,obj:a(this)},function(l){l.preventDefault();h.setMenuItem(l.data.obj,l.data.id);});if(d===0){h.setMenuItem(a(this),k);}d++;});})(c,this,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{logo:"logo.png",logoWidth:49,logoHeight:15,logopos:"sw",logox:5,logoy:5,link:"http://www.mediafront.org",file:"",image:"",timeout:2000,autoLoad:true});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{busy:"#mediabusy",preview:"#mediapreview",play:"#mediaplay",media:"#mediadisplay",control:"#mediacontrol"});jQuery.fn.minplayer=function(b){if(this.length===0){return null;}return new (function(d,e){e=jQuery.media.utils.getSettings(e);this.display=d;var g=this;this.autoLoad=e.autoLoad;this.controller=null;this.activeController=null;this.busy=d.find(e.ids.busy);this.busyImg=this.busy.find("img");this.busyWidth=this.busyImg.width();this.busyHeight=this.busyImg.height();this.play=d.find(e.ids.play);this.play.bind("click",function(){g.togglePlayPause();});this.playImg=this.play.find("img");this.playWidth=this.playImg.width();this.playHeight=this.playImg.height();this.preview=null;this.usePlayerControls=false;this.busyFlags=0;this.playVisible=false;this.previewVisible=false;this.controllerVisible=true;this.hasMedia=false;this.playing=false;this.width=this.display.width();this.height=this.display.height();this.showElement=function(j,h,i){if(j&&!this.usePlayerControls){if(h){j.show(i);}else{j.hide(i);}}};this.showPlay=function(h,i){this.playVisible=h;this.showElement(this.play,h,i);};this.showBusy=function(j,h,i){if(h){this.busyFlags|=(1<<j);}else{this.busyFlags&=~(1<<j);}this.showElement(this.busy,(this.busyFlags>0),i);};this.showPreview=function(h,i){this.previewVisible=h;if(this.preview){this.showElement(this.preview.display,h,i);}};this.showController=function(h,i){this.controllerVisible=h;if(this.controller){this.showElement(this.controller.display,h,i);}};this.onControlUpdate=function(h){if(this.media){if(this.media.playerReady){switch(h.type){case"play":this.media.player.playMedia();break;case"pause":this.media.player.pauseMedia();break;case"seek":this.media.player.seekMedia(h.value);break;case"volume":this.media.player.setVolume(h.value);break;case"mute":this.media.mute(h.value);break;}}else{if((this.media.playQueue.length>0)&&!this.media.mediaFile){this.autoLoad=true;this.playNext();}}if(e.template&&e.template.onControlUpdate){e.template.onControlUpdate(h);}}};this.fullScreen=function(h){if(e.template.onFullScreen){e.template.onFullScreen(h);}};this.onPreviewLoaded=function(){this.previewVisible=true;};this.onMediaUpdate=function(h){switch(h.type){case"paused":this.playing=false;this.showPlay(true);this.showBusy(1,false);break;case"playing":this.playing=true;this.showPlay(false);this.showBusy(1,false);this.showPreview((this.media.mediaFile.type=="audio"));break;case"initialize":this.playing=false;this.showPlay(true);this.showBusy(1,this.autoLoad);this.showPreview(true);break;case"buffering":this.showPlay(true);this.showBusy(1,true);this.showPreview((this.media.mediaFile.type=="audio"));break;}if(this.controller){this.controller.onMediaUpdate(h);}if(this.activeController){this.activeController.onMediaUpdate(h);}if(e.template&&e.template.onMediaUpdate){e.template.onMediaUpdate(h);}};this.addController=function(i,h){if(i){i.display.bind("controlupdate",i,function(j,k){g.activeController=j.data;g.onControlUpdate(k);});if(h&&!this.activeController){this.activeController=i;}}return i;};this.media=this.display.find(e.ids.media).mediadisplay(e);if(this.media){this.media.display.bind("mediaupdate",function(h,i){g.onMediaUpdate(i);});this.media.display.bind("click",function(){g.togglePlayPause();});}this.controller=this.addController(this.display.find(e.ids.control).mediacontrol(e),false);if(jQuery.media.controllers[e.id]){var f=jQuery.media.controllers[e.id];var c=f.length;while(c--){this.addController(f[c],true);}}this.setSize=function(i,h){this.width=i?i:this.width;this.height=h?h:this.height;if(this.width&&this.height){this.setLogoPos();if(this.preview){this.preview.resize(this.width,this.height);}this.busy.css({width:this.width,height:this.height});this.busyImg.css({marginLeft:((this.width-this.busyWidth)/2)+"px",marginTop:((this.height-this.busyHeight)/2)+"px"});this.play.css({width:this.width,height:this.height});this.playImg.css({marginLeft:((this.width-this.playWidth)/2)+"px",marginTop:((this.height-this.playHeight)/2)+"px"});if(this.media){this.media.display.css({width:this.width,height:this.height});this.media.setSize(this.width,this.height);}}};this.showPlayerController=function(h){if(this.media&&this.media.hasControls()){this.usePlayerControls=h;if(h){this.busy.hide();this.play.hide();if(this.preview){this.preview.display.hide();}if(this.controller){this.controller.display.hide();}}else{this.showBusy(1,((this.busyFlags&2)==2));this.showPlay(this.playVisible);this.showPreview(this.previewVisible);this.showController(this.controllerVisible);}this.media.showControls(h);}};if(this.media){this.display.prepend('<div class="medialogo"></div>');this.logo=this.display.find(".medialogo").mediaimage(e.link);this.logo.display.css({position:"absolute",zIndex:490});this.logo.width=e.logoWidth;this.logo.height=e.logoHeight;this.logo.loadImage(e.logo);}this.setLogoPos=function(){if(this.logo){var i=parseInt(this.media.display.css("marginTop"),0);var h=parseInt(this.media.display.css("marginLeft"),0);var k=(e.logopos=="se"||e.logopos=="sw")?(i+this.height-this.logo.height-e.logoy):i+e.logoy;var j=(e.logopos=="ne"||e.logopos=="se")?(h+this.width-this.logo.width-e.logox):h+e.logox;this.logo.display.css({marginTop:k,marginLeft:j});}};this.onResize=function(i,h){if(this.controller){this.controller.onResize(i,h);}this.setSize(this.width+i,this.height+h);};this.reset=function(){this.hasMedia=false;this.playing=false;if(this.controller){this.controller.reset();}if(this.activeController){this.activeController.reset();}this.showBusy(1,this.autoLoad);if(this.media){this.media.reset();}};this.togglePlayPause=function(){if(this.media){if(this.media.playerReady){if(this.playing){this.showPlay(true);this.media.player.pauseMedia();}else{this.showPlay(false);this.media.player.playMedia();}}else{if((this.media.playQueue.length>0)&&!this.media.mediaFile){this.autoLoad=true;this.playNext();}}}};this.loadImage=function(h){this.preview=d.find(e.ids.preview).mediaimage();if(this.preview){this.preview.resize(this.width,this.height);this.preview.display.bind("imageLoaded",function(){g.onPreviewLoaded();});this.preview.loadImage(h);if(this.media){this.media.preview=h;}}};this.clearImage=function(){if(this.preview){this.preview.clear();}};this.loadFiles=function(h){this.reset();if(this.media&&this.media.loadFiles(h)&&this.autoLoad){this.media.playNext();}};this.playNext=function(){if(this.media){this.media.playNext();}};this.loadMedia=function(h){this.reset();if(this.media){this.media.loadMedia(h);}};if(e.file){this.loadMedia(e.file);}if(e.image){this.loadImage(e.image);}})(this,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{node:"",incrementTime:5});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{voter:"#mediavoter",uservoter:"#mediauservoter",mediaRegion:"#mediaregion",field:".mediafield"});jQuery.fn.medianode=function(c,b){if(this.length===0){return null;}return new (function(f,e,d){d=jQuery.media.utils.getSettings(d);this.display=e;this.nodeInfo={};this.incremented=false;var g=this;this.player=this.display.find(d.ids.mediaRegion).minplayer(d);if(this.player&&this.player.media&&(d.incrementTime!==0)){this.player.media.display.bind("mediaupdate",function(h,i){g.onMediaUpdate(i);});}this.images=[];this.width=this.display.width();this.height=this.display.height();this.voter=this.display.find(d.ids.voter).mediavoter(d,f,false);this.uservoter=this.display.find(d.ids.uservoter).mediavoter(d,f,true);if(this.uservoter&&this.voter){this.uservoter.display.bind("processing",function(){g.player.showBusy(2,true);});this.uservoter.display.bind("voteGet",function(){g.player.showBusy(2,false);});this.uservoter.display.bind("voteSet",function(i,h){g.player.showBusy(2,false);g.voter.updateVote(h);});}this.onMediaUpdate=function(h){if(!this.incremented){switch(h.type){case"update":if((d.incrementTime>0)&&(h.currentTime>d.incrementTime)){this.incremented=true;f.call(jQuery.media.commands.incrementCounter,null,null,g.nodeInfo.nid);}break;case"complete":if(d.incrementTime<0){this.incremented=true;f.call(jQuery.media.commands.incrementCounter,null,null,g.nodeInfo.nid);}break;}}};this.loadNode=function(h){return this.getNode(this.translateNode(h));};this.translateNode=function(i){var j=((typeof i)=="number")||((typeof i)=="string");if(!i){var h=d.node;if((typeof h)=="object"){h.load=false;return h;}else{return h?{nid:h,load:true}:null;}}else{if(j){return{nid:i,load:true};}else{i.load=false;return i;}}};this.onResize=function(j,h){if(this.player){this.player.onResize(j,h);}var k=this.images.length;while(k--){this.images[k].refresh();}};this.getNode=function(h){if(h){if(f&&h.load){f.call(jQuery.media.commands.loadNode,function(i){g.setNode(i);},null,h.nid,{});}else{this.setNode(h);}return true;}return false;};this.setNode=function(h){if(h){this.nodeInfo=h;this.incremented=false;if(this.player&&this.nodeInfo.mediafiles){var i=this.getImage("preview");if(i){this.player.loadImage(i.path);}else{this.player.clearImage();}this.player.loadFiles(this.nodeInfo.mediafiles.media);}if(this.voter){this.voter.getVote(h);}if(this.uservoter){this.uservoter.getVote(h);}this.display.find(d.ids.field).each(function(){g.setField(this,h,a(this).attr("type"),a(this).attr("field"));});this.display.trigger("nodeload",this.nodeInfo);}};this.setField=function(j,i,h,k){if(h){switch(h){case"text":this.setTextField(j,i,k);return true;case"image":return this.setImageField(j,k);default:if(d.template.setField){return d.template.setField({node:i,field:j,fieldType:h,fieldName:k});}else{return true;}}}};this.setTextField=function(i,h,k){var j=h[k];if(j){a(i).empty().html(j);}};this.getImage=function(j){var h=this.nodeInfo.mediafiles?this.nodeInfo.mediafiles.images:null;var k=null;if(h){if(h[j]){k=h[j];}else{for(var i in h){if(h.hasOwnProperty(i)){k=h[i];break;}}}k=(typeof k==="string")?{path:k}:k;k.path=k.path?jQuery.trim(k.path):(d.baseURL+jQuery.trim(k.filepath));if(k&&k.path){k.path=k.path?jQuery.trim(k.path):(d.baseURL+jQuery.trim(k.filepath));}else{k=null;}}return k;};this.setImageField=function(j,l){var h=true;var i=this.getImage(l);if(i){var k=a(j).empty().mediaimage();this.images.push(k);k.loadImage(i.path);h=false;}return h;};})(c,this,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{shuffle:false,loop:false,pageLimit:10});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{prev:"#mediaprev",next:"#medianext",loadPrev:"#medialoadprev",loadNext:"#medialoadnext",prevPage:"#mediaprevpage",nextPage:"#medianextpage"});jQuery.fn.mediapager=function(b){return new (function(c,d){d=jQuery.media.utils.getSettings(d);this.display=c;var e=this;this.activeIndex=-1;this.currentIndex=-1;this.activePage=0;this.currentPage=0;this.numPages=0;this.numItems=10;this.activeNumItems=10;this.loadState="";this.enabled=false;this.prevButton=c.find(d.ids.prev).medialink(d,function(){if(e.enabled){e.loadPrev(false);}});this.nextButton=c.find(d.ids.next).medialink(d,function(){if(e.enabled){e.loadNext(false);}});this.loadPrevButton=c.find(d.ids.loadPrev).medialink(d,function(){if(e.enabled){e.loadPrev(true);}});this.loadNextButton=c.find(d.ids.loadNext).medialink(d,function(){if(e.enabled){e.loadNext(true);}});this.prevPageButton=c.find(d.ids.prevPage).medialink(d,function(){if(e.enabled){e.loadState="click";e.prevPage();}});this.nextPageButton=c.find(d.ids.nextPage).medialink(d,function(){if(e.enabled){e.loadState="click";e.nextPage();}});this.setTotalItems=function(f){if(f&&d.pageLimit){this.numPages=Math.ceil(f/d.pageLimit);if(this.numPages==1){this.numItems=f;}}};this.setNumItems=function(f){this.numItems=f;};this.reset=function(){this.activePage=0;this.currentPage=0;this.activeIndex=-1;this.currentIndex=-1;this.loadState="";};this.loadIndex=function(h){var f=h?"activeIndex":"currentIndex";var g=this[f];switch(this.loadState){case"prev":this.loadState="";this.loadPrev(h);return;case"first":g=0;break;case"last":g=(this.numItems-1);break;case"rand":g=Math.floor(Math.random()*this.numItems);break;}this.loadState="";if(g!=this[f]){this.loadState="";this[f]=g;this.display.trigger("loadindex",{index:this[f],active:h});}};this.loadNext=function(g){if(this.loadState){this.loadIndex(g);}else{if(d.shuffle){this.loadRand();}else{var f=g?"activeIndex":"currentIndex";if(g&&(this.activePage!=this.currentPage)){if((this.activeIndex==(this.activeNumItems-1))&&(this.activePage==(this.currentPage-1))){this.currentIndex=this.activeIndex=0;this.activePage=this.currentPage;this.display.trigger("loadindex",{index:0,active:true});}else{this.currentPage=this.activePage;this.loadState="";this.display.trigger("loadpage",{index:this.activePage,active:g});}}else{this[f]++;if(this[f]>=this.numItems){if(this.numPages>1){this[f]=(this.numItems-1);this.loadState=this.loadState?this.loadState:"first";this.nextPage(g);}else{if(!g||d.loop){this[f]=0;this.display.trigger("loadindex",{index:this[f],active:g});}}}else{this.display.trigger("loadindex",{index:this[f],active:g});}}}}};this.loadPrev=function(g){var f=g?"activeIndex":"currentIndex";if(g&&(this.activePage!=this.currentPage)){this.currentPage=this.activePage;this.loadState="prev";this.display.trigger("loadpage",{index:this.activePage,active:g});}else{this[f]--;if(this[f]<0){if(this.numPages>1){this[f]=0;this.loadState=this.loadState?this.loadState:"last";this.prevPage(g);}else{if(!g||d.loop){this[f]=(this.numItems-1);this.display.trigger("loadindex",{index:this[f],active:g});}}}else{this.display.trigger("loadindex",{index:this[f],active:g});}}};this.loadRand=function(){var f=Math.floor(Math.random()*this.numPages);if(f!=this.activePage){this.activePage=f;this.loadState=this.loadState?this.loadState:"rand";this.display.trigger("loadpage",{index:this.activePage,active:true});}else{this.activeIndex=Math.floor(Math.random()*this.numItems);this.display.trigger("loadindex",{index:this.activeIndex,active:true});}};this.nextPage=function(h){var f=h?"activePage":"currentPage";var g=false;if(this[f]<(this.numPages-1)){this[f]++;g=true;}else{if(d.loop){this.loadState=this.loadState?this.loadState:"first";this[f]=0;g=true;}else{this.loadState="";}}this.setPageState(h);if(g){this.display.trigger("loadpage",{index:this[f],active:h});}};this.prevPage=function(h){var f=h?"activePage":"currentPage";var g=false;if(this[f]>0){this[f]--;g=true;}else{if(d.loop){this.loadState=this.loadState?this.loadState:"last";this[f]=(this.numPages-1);g=true;}else{this.loadState="";}}this.setPageState(h);if(g){this.display.trigger("loadpage",{index:this[f],active:h});}};this.setPageState=function(f){if(f){this.currentPage=this.activePage;}else{this.activeNumItems=this.numItems;}};})(this,b);};jQuery.media=jQuery.extend({},{parser:function(b){return new (function(c){var d=this;this.onLoaded=null;this.parseFile=function(e,f){this.onLoaded=f;jQuery.ajax({type:"GET",url:e,dataType:"xml",success:function(g){d.parseXML(g);},error:function(g,i,h){console.log("Error: "+i);}});};this.parseXML=function(e){var f=this.parseXSPF(e);if(f.total_rows===0){f=this.parseASX(e);}if(f.total_rows===0){f=this.parseRSS(e);}if(this.onLoaded&&f.total_rows){this.onLoaded(f);}return f;};this.parseXSPF=function(e){var g={total_rows:0,nodes:[]};var f=jQuery("playlist trackList track",e);if(f.length>0){f.each(function(h){g.total_rows++;g.nodes.push({nid:g.total_rows,title:a(this).find("title").text(),description:a(this).find("annotation").text(),mediafiles:{images:{image:{path:a(this).find("image").text()}},media:{media:{path:a(this).find("location").text()}}}});});}return g;};this.parseASX=function(e){var g={total_rows:0,nodes:[]};var f=jQuery("asx entry",e);if(f.length>0){f.each(function(h){g.total_rows++;g.nodes.push({nid:g.total_rows,title:a(this).find("title").text(),mediafiles:{images:{image:{path:a(this).find("image").text()}},media:{media:{path:a(this).find("location").text()}}}});});}return g;};this.parseRSS=function(f){var h={total_rows:0,nodes:[]};var g=jQuery("rss channel",f);if(g.length>0){var e=(g.find("generator").text()=="YouTube data API");g.find("item").each(function(i){h.total_rows++;var j={};j=e?d.parseYouTubeItem(a(this)):d.parseRSSItem(a(this));j.nid=h.total_rows;h.nodes.push(j);});}return h;};this.parseRSSItem=function(e){return{title:e.find("title").text(),mediafiles:{images:{image:{path:e.find("image").text()}},media:{media:{path:e.find("location").text()}}}};};this.parseYouTubeItem=function(f){var e=f.find("description").text();var g=f.find("link").text().replace("&feature=youtube_gdata","");return{title:f.find("title").text(),mediafiles:{images:{image:{path:jQuery("img",e).eq(0).attr("src")}},media:{media:{path:g,player:"youtube"}}}};};})(b);}},jQuery.media);jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{protocol:"auto",server:"drupal",template:"default",baseURL:"",debug:false,draggable:false,resizable:false,showPlaylist:true,autoNext:true,prefix:""});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{loading:"#mediaplayerloading",player:"#mediaplayer",menu:"#mediamenu",titleBar:"#mediatitlebar",node:"#medianode",playlist:"#mediaplaylist"});jQuery.media.players={};jQuery.media.loadCallbacks={};jQuery.media.playlists={};jQuery.media.controllers={};jQuery.media.onLoaded=function(b,d){var c=jQuery.media.players[b];if(c&&c.display&&c.loaded){d(c);}else{if(!jQuery.media.loadCallbacks[b]){jQuery.media.loadCallbacks[b]=[];}jQuery.media.loadCallbacks[b].push(d);}};jQuery.media.addController=function(b,d){if(d&&d.node&&d.node.player&&d.node.player.controller){var c=jQuery.media.players[b];if(c&&c.node&&c.node.player){c.node.player.addController(d.node.player.controller);}else{if(!jQuery.media.controllers[b]){jQuery.media.controllers[b]=[];}jQuery.media.controllers[b].push(d.node.player.controller);}}};jQuery.media.addPlaylist=function(b,d){if(d&&d.playlist){var c=jQuery.media.players[b];if(c){c.addPlaylist(d.playlist);}else{if(!jQuery.media.playlists[b]){jQuery.media.playlists[b]=[];}jQuery.media.playlists[b].push(d.playlist);}}};jQuery.fn.mediaplayer=function(b){if(this.length===0){return null;}return new (function(e,f){f=jQuery.media.utils.getSettings(f);if(!f.id){f.id=jQuery.media.utils.getId(e);}this.dialog=e;this.display=this.dialog.find(f.ids.player);var h=this;var c=[];jQuery.media.utils.checkVisibility(this.display,c);jQuery.media.players[f.id]=this;this.loaded=false;f.template=jQuery.media.templates[f.template](this,f);if(f.template.getSettings){f=jQuery.extend(f,f.template.getSettings());}a(window).keypress(function(i){switch(i.keyCode){case 0:h.onSpaceBar();break;case 27:h.onEscKey();break;}});if(jQuery.media[f.protocol]){this.protocol=jQuery.media[f.protocol](f);}if(jQuery.media[f.server]){this.server=jQuery.media[f.server](this.protocol,f);}this.width=this.dialog.width();this.height=this.dialog.height();this.menu=this.display.find(f.ids.menu).mediamenu(this.server,f);if(this.menu){this.menu.display.bind("menuclose",function(){h.showMenu(false);});}this.menuOn=false;this.maxOn=!f.showPlaylist;this.fullScreen=false;this.playlist=null;this.activePlaylist=null;this.showMenu=function(i){if(f.template.onMenu){this.menuOn=i;f.template.onMenu(this.menuOn);}};this.onEscKey=function(){if(this.fullScreen){this.fullScreen=false;if(this.node&&this.node.player){this.node.player.fullScreen(this.fullScreen);}}};this.onSpaceBar=function(){if(this.fullScreen&&this.node&&this.node.player){this.node.player.togglePlayPause();}};this.addPlayerEvents=function(i){i.display.bind("menu",function(j){h.showMenu(!h.menuOn);});i.display.bind("maximize",function(j){h.maximize(!h.maxOn);});i.display.bind("fullscreen",function(j){h.fullScreen=!h.fullScreen;if(h.node&&h.node.player){h.node.player.fullScreen(h.fullScreen);}});};this.titleBar=this.dialog.find(f.ids.titleBar).mediatitlebar(f);if(this.titleBar){this.addPlayerEvents(this.titleBar);if(f.draggable&&this.dialog.draggable){this.dialog.draggable({handle:f.ids.titleBar,containment:"document"});}if(f.resizable&&this.dialog.resizable){this.dialog.resizable({alsoResize:this.display,containment:"document",resize:function(i){h.setSize(h.dialog.width(),h.dialog.height());}});}}this.node=this.display.find(f.ids.node).medianode(this.server,f);if(this.node){this.addPlayerEvents(this.node);this.node.display.bind("nodeload",function(i,j){h.onNodeLoad(j);});if(this.node.player&&this.node.player.media){this.node.player.media.display.bind("mediaupdate",function(i,j){h.onMediaUpdate(j);});}if(this.node.uservoter){this.node.uservoter.display.bind("voteSet",function(j,i){if(h.activePlaylist){h.activePlaylist.onVoteSet(i);}});}}this.onMediaUpdate=function(i){if(f.autoNext&&this.activePlaylist&&(i.type=="complete")){this.activePlaylist.loadNext();}if(this.menu&&this.node&&(i.type=="meta")){this.menu.setEmbedCode(this.node.player.media.player.getEmbedCode());this.menu.setMediaLink(this.node.player.media.player.getMediaLink());}};this.onPlaylistLoad=function(i){if(this.node){this.node.loadNode(i);}if(f.template.onPlaylistLoad){f.template.onPlaylistLoad(i);}};this.onNodeLoad=function(i){if(f.template.onNodeLoad){f.template.onNodeLoad(i);}};this.onResize=function(j,i){if(f.template.onResize){f.template.onResize(j,i);}if(this.playlist){this.playlist.onResize(j,i);}if(this.node){this.node.onResize(j,i);}};this.maximize=function(i){if(!this.fullScreen){if(f.template.onMaximize&&(i!=this.maxOn)){this.maxOn=i;f.template.onMaximize(this.maxOn);}}};this.addPlaylist=function(i){if(i){i.display.bind("playlistload",i,function(j,k){h.activePlaylist=j.data;h.onPlaylistLoad(k);});if(!this.activePlaylist&&i.activeTeaser){this.activePlaylist=i;this.onPlaylistLoad(i.activeTeaser.node.nodeInfo);}}return i;};this.playlist=this.addPlaylist(this.display.find(f.ids.playlist).mediaplaylist(this.server,f));if(jQuery.media.playlists[f.id]){var g=jQuery.media.playlists[f.id];var d=g.length;while(d--){this.addPlaylist(g[d]);}}this.setSize=function(l,k){l=l?l:this.width;k=k?k:this.height;if((l!=this.width)||(k!=this.height)){var j=(l-this.width);var i=(k-this.height);this.width=l;this.height=k;this.dialog.css({width:this.width,height:this.height});this.onResize(j,i);}};this.loadContent=function(){var i=false;if(this.playlist){i=this.playlist.loadPlaylist();}if(!i&&this.node){if(this.node.player&&this.node.player.media){this.node.player.media.settings.repeat=(f.loop||f.repeat);}this.node.loadNode();}};this.initializeTemplate=function(){if(f.template.initialize){f.template.initialize(f);}jQuery.media.utils.resetVisibility(c);};this.load=function(){this.initializeTemplate();this.onResize(0,0);this.dialog.css("position","relative");this.dialog.css("marginLeft",0);this.dialog.css("overflow","visible");this.loaded=true;this.display.trigger("playerLoaded",this);if(jQuery.media.loadCallbacks[f.id]){var k=jQuery.media.loadCallbacks[f.id];var j=k.length;while(j--){k[j](this);}}this.server.connect(function(i){h.loadContent();});};this.load();})(this,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{playlist:"",args:[],wildcard:"*"});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{pager:"#mediapager",scroll:"#mediascroll",busy:"#mediabusy",links:"#medialinks"});jQuery.fn.mediaplaylist=function(c,b){if(this.length===0){return null;}return new (function(e,f,d){d=jQuery.media.utils.getSettings(d);this.display=f;var g=this;this.allowResize=true;this.teasers=[];this.selectedTeaser=null;this.activeTeaser=null;this.args=d.args;this.setActive=true;this.activePager=null;this.pager=null;this.parser=jQuery.media.parser(d);this.scrollRegion=f.find(d.ids.scroll).mediascroll(d);this.scrollRegion.clear();this.width=this.scrollRegion.width;this.height=this.scrollRegion.height;if(d.vertical){this.display.width(this.width);}else{this.display.height(this.height);}this.busy=f.find(d.ids.busy);this.busyVisible=false;this.busyImg=this.busy.find("img");this.busyWidth=this.busyImg.width();this.busyHeight=this.busyImg.height();this.links=f.find(d.ids.links).medialinks(d);this.links.loadLinks();this.loading=function(h){if(this.pager){this.pager.enabled=!h;}if(this.activePager){this.activePager.enabled=!h;}if(h){this.busyVisible=true;this.busy.show();}else{this.busyVisible=false;this.busy.hide();}};this.onResize=function(i,h){if(this.allowResize){this.width+=i;this.height+=h;this.pagerWidth+=i;this.scrollRegion.onResize(i,h);if(this.pager){this.pager.display.width(this.width);}this.busy.css({width:this.width,height:this.height});this.busyImg.css({marginLeft:((this.width-this.busyWidth)/2)+"px",marginTop:((this.height-this.busyHeight)/2)+"px"});}};this.addPager=function(h,i){if(h){h.display.bind("loadindex",function(j,k){if(k.active){g.activateTeaser(g.teasers[k.index]);}else{g.selectTeaser(g.teasers[k.index]);}});h.display.bind("loadpage",function(j,k){g.setActive=k.active;g.loadPlaylist({pageIndex:k.index});});if(i&&!this.activePager){this.activePager=h;}}return h;};this.pager=this.addPager(f.find(d.ids.pager).mediapager(d),false);this.links.display.bind("linkclick",function(i,h){g.onLinkClick(h);});this.onLinkClick=function(k){var i=k.index;var j=k.playlist;var h=[];h[i]=k.arg;if(this.pager){this.pager.reset();}if(this.activePager){this.activePager.reset();}this.loadPlaylist({playlist:j,args:h});};this.loadNext=function(){if(this.pager){this.pager.loadNext(true);}else{if(this.activePager){this.activePager.loadNext(true);}}};this.loadPlaylist=function(h){var j={playlist:d.playlist,pageLimit:d.pageLimit,pageIndex:(this.pager?this.pager.activePage:0),args:{}};var i=jQuery.extend({},j,h);this.setArgs(i.args);this.loading(true);if(i.playlist){if(((typeof i.playlist)=="object")){d.playlist=i.playlist.name;this.setPlaylist(i.playlist);}else{if(i.playlist.match(/^http[s]?\:\/\/|\.xml$/i)){this.parser.parseFile(i.playlist,function(k){g.setPlaylist(k);});}else{if(e){e.call(jQuery.media.commands.getPlaylist,function(k){g.setPlaylist(k);},null,i.playlist,i.pageLimit,i.pageIndex,this.args);}}}return true;}return false;};this.setPlaylist=function(k){if(k&&k.nodes){var h=[];jQuery.media.utils.checkVisibility(this.display,h);if(this.pager){this.pager.setTotalItems(k.total_rows);}if(this.activePager){this.activePager.setTotalItems(k.total_rows);}this.scrollRegion.clear();this.resetTeasers();var j=k.nodes.length;for(var i=0;i<j;i++){this.addTeaser(k.nodes[i],i);}this.scrollRegion.activate();if(this.pager){this.pager.loadNext(this.setActive);}if(this.activePager){this.activePager.loadNext(this.setActive);}jQuery.media.utils.resetVisibility(h);}this.loading(false);};this.onVoteSet=function(h){if(h){var k=this.teasers.length;while(k--){var j=this.teasers[k];if(j.node.nodeInfo.nid==h.content_id){j.node.voter.updateVote(h);}}}};this.addTeaser=function(j,h){var i=this.scrollRegion.newItem().mediateaser(e,j,h,d);if(i){i.display.bind("click",i,function(k){g.activateTeaser(k.data);});if(this.activeTeaser){this.activeTeaser.setActive(j.nid==this.activeTeaser.node.nodeInfo.nid);}if(this.selectedTeaser){this.selectedTeaser.setSelected(j.nid==this.selectedTeaser.node.nodeInfo.nid);}this.teasers.push(i);}};this.resetTeasers=function(){var h=this.teasers.length;while(h--){this.teasers[h].reset();}this.teasers=[];};this.refresh=function(){this.scrollRegion.refresh();var h=this.teasers.length;while(h--){this.teasers[h].refresh();}};this.setArgs=function(j){if(j){this.args=d.args;var k=j.length;while(k--){var h=j[k];if(h&&(h!=d.wildcard)){this.args[k]=h;}}}};this.selectTeaser=function(h){if(this.selectedTeaser){this.selectedTeaser.setSelected(false);}this.selectedTeaser=h;if(this.selectedTeaser){this.selectedTeaser.setSelected(true);this.scrollRegion.setVisible(h.index);}};this.activateTeaser=function(h){this.selectTeaser(h);if(this.activeTeaser){this.activeTeaser.setActive(false);}this.activeTeaser=h;if(this.activeTeaser){this.activeTeaser.setActive(true);if(this.pager){this.pager.activeIndex=this.pager.currentIndex=h.index;}if(this.activePager){this.activePager.activeIndex=this.activePager.currentIndex=h.index;}this.display.trigger("playlistload",h.node.nodeInfo);}};})(c,this,b);};jQuery.media.ids=jQuery.extend(jQuery.media.ids,{linkText:"#medialinktext"});jQuery.fn.playlistlink=function(c,b){return new (function(f,e,d){e=jQuery.media.utils.getSettings(e);this.display=f;this.arg=d.arg;this.text=d.text;this.index=d.index;this.display.medialink(e,function(g){_this.display.trigger("linkclick",g.data);},this);this.setActive=function(g){if(e.template.onLinkSelect){e.template.onLinkSelect(_this,g);}};this.display.find(e.ids.linkText).html(this.text);})(this,c,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{rotatorTimeout:5000,rotatorTransition:"fade",rotatorEasing:"swing",rotatorSpeed:"slow",rotatorHover:false});jQuery.fn.mediarotator=function(b){if(this.length===0){return null;}return new (function(e,d){d=jQuery.media.utils.getSettings(d);var f=this;this.images=[];this.imageIndex=0;this.imageInterval=null;this.width=0;this.height=0;this.onImageLoaded=function(){this.width=this.images[0].imgLoader.width;this.height=this.images[0].imgLoader.height;e.css({width:this.width+"px",height:this.height+"px"});var g=(d.rotatorTransition=="hscroll")?(2*this.width):this.width;var h=(d.rotatorTransition=="vscroll")?(2*this.height):this.height;this.display.css({width:g,height:h});};this.addImage=function(){var g=a("<div></div>").mediaimage(null,true);this.display.append(g.display);if((d.rotatorTransition=="hscroll")||(d.rotatorTransition=="vscroll")){g.display.css({"float":"left"});}else{g.display.css({position:"absolute",zIndex:(200-this.images.length),top:0,left:0});}return g;};this.loadImages=function(g){this.images=[];this.imageIndex=0;jQuery.each(g,function(h){var i=f.addImage();if(h===0){i.display.bind("imageLoaded",function(){f.onImageLoaded();}).show();}i.loadImage(this);f.images.push(i);});if(d.rotatorHover){this.display.bind("mouseenter",function(){f.startRotator();}).bind("mouseleave",function(){clearInterval(f.imageInterval);});}else{this.startRotator();}};this.startRotator=function(){clearInterval(this.imageInterval);this.imageInterval=setInterval(function(){f.showNextImage();},d.rotatorTimeout);};this.showNextImage=function(){this.hideImage(this.images[this.imageIndex].display);this.imageIndex=(this.imageIndex+1)%this.images.length;this.showImage(this.images[this.imageIndex].display);};this.showImage=function(g){if(d.rotatorTransition==="fade"){g.fadeIn(d.rotatorSpeed);}else{g.css({marginLeft:0,marginTop:0}).show();}};this.hideImage=function(g){switch(d.rotatorTransition){case"fade":g.fadeOut(d.rotatorSpeed);break;case"hscroll":g.animate({marginLeft:-this.width},d.rotatorSpeed,d.rotatorEasing,function(){g.css({marginLeft:0}).remove();f.display.append(g);});break;case"vscroll":g.animate({marginTop:-this.height},d.rotatorSpeed,d.rotatorEasing,function(){g.css({marginTop:0}).remove();f.display.append(g);});break;default:g.hide();break;}};var c=[];e.find("img").each(function(){c.push(a(this).attr("src"));});e.empty().css("overflow","hidden").append(a('<div class="imagerotatorinner"></div>'));this.display=e.find(".imagerotatorinner");if(c.length){this.loadImages(c);}})(this,b);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{gateway:""});jQuery.media=jQuery.extend({},{rpc:function(b){return new (function(c){c=jQuery.media.utils.getSettings(c);var d=this;this.parseObject=function(h){var e="";if(h instanceof Date){e="<dateTime.iso8601>";e+=h.getFullYear();e+=h.getMonth();e+=h.getDate();e+="T";e+=h.getHours()+":";e+=h.getMinutes()+":";e+=h.getSeconds();e+="</dateTime.iso8601>";}else{if(h instanceof Array){e="<array><data>\n";for(var g=0;g<h.length;g++){e+="  <value>"+this.serializeToXML(h[g])+"</value>\n";}e+="</data></array>";}else{e="<struct>\n";for(var f in h){if(h.hasOwnProperty(f)){e+="  <member><name>"+f+"</name><value>";e+=this.serializeToXML(h[f])+"</value></member>\n";}}e+="</struct>";}}return e;};this.serializeToXML=function(f){switch(typeof f){case"boolean":return"<boolean>"+((f)?"1":"0")+"</boolean>";case"number":var e=parseInt(f,10);if(e==f){return"<int>"+f+"</int>";}return"<double>"+f+"</double>";case"string":return"<string>"+f+"</string>";case"object":return this.parseObject(f);}};this.parseXMLValue=function(f){var m=jQuery(f).children();var k=m.length;var n=function(i){return function(){i.push(d.parseXMLValue(this));};};var l=function(i){return function(){i[jQuery("> name",this).text()]=d.parseXMLValue(jQuery("value",this));};};for(var h=0;h<k;h++){var j=m[h];switch(j.tagName){case"boolean":return(jQuery(j).text()==1);case"int":return parseInt(jQuery(j).text(),10);case"double":return parseFloat(jQuery(j).text());case"string":return jQuery(j).text();case"array":var e=[];jQuery("> data > value",j).each(n(e));return e;case"struct":var g={};jQuery("> member",j).each(l(g));return g;case"dateTime.iso8601":return NULL;}}};this.parseXML=function(f){var e={};e.version="1.0";jQuery("methodResponse params param > value",f).each(function(g){e.result=d.parseXMLValue(this);});jQuery("methodResponse fault > value",f).each(function(g){e.error=d.parseXMLValue(this);});return e;};this.xmlRPC=function(j,h){var e='<?xml version="1.0"?>';e+="<methodCall>";e+="<methodName>"+j+"</methodName>";if(h.length>0){e+="<params>";var g=h.length;for(var f=0;f<g;f++){if(h[f]){e+="<param><value>"+this.serializeToXML(h[f])+"</value></param>";}}e+="</params>";}e+="</methodCall>";return e;};this.call=function(i,h,e,g,f){if(c.gateway){jQuery.ajax({url:c.gateway,dataType:"xml",type:"POST",data:this.xmlRPC(i,g),error:function(j,l,k){if(e){e(l);}else{console.log("Error: "+l);}},success:function(k){var j=d.parseXML(k);if(j.error){if(e){e(j.error);}else{console.dir(j.error);}}else{if(h){h(j.result);}}},processData:false,contentType:"text/xml"});}else{if(h){h(null);}}};})(b);}},jQuery.media);jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{vertical:true,scrollSpeed:20,updateTimeout:40,hysteresis:40,showScrollbar:true,scrollMode:"auto"});jQuery.media.ids=jQuery.extend(jQuery.media.ids,{listMask:"#medialistmask",list:"#medialist",scrollWrapper:"#mediascrollbarwrapper",scrollBar:"#mediascrollbar",scrollTrack:"#mediascrolltrack",scrollHandle:"#mediascrollhandle",scrollUp:"#mediascrollup",scrollDown:"#mediascrolldown"});jQuery.fn.mediascroll=function(b){return new (function(c,e){e=jQuery.media.utils.getSettings(e);this.display=c;var f=this;this.spanMode=(e.scrollMode=="span");this.listMask=c.find(e.ids.listMask);if(this.spanMode||(e.scrollMode=="auto")){this.listMask.bind("mouseenter",function(g){f.onMouseOver(g);});this.listMask.bind("mouseleave",function(g){f.onMouseOut(g);});this.listMask.bind("mousemove",function(g){f.onMouseMove(g);});}this.listMask.css("overflow","hidden");this.list=c.find(e.ids.list);var d=this.list.children().eq(0);this.elementWidth=d.width();this.elementHeight=d.height();this.elementSize=e.vertical?d.outerHeight(true):d.outerWidth(true);if(jQuery.browser.msie&&parseInt(jQuery.fn.jquery.replace(".",""),10)<132){this.template=a("<div></div>").append(jQuery.media.utils.cloneFix(d)).html();}else{this.template=a("<div></div>").append(d.clone()).html();}this.width=this.listMask.width();this.height=e.vertical?0:this.listMask.height();this.list.empty();this.pagePos=e.vertical?"pageY":"pageX";this.margin=e.vertical?"marginTop":"marginLeft";this.scrollSize=e.vertical?0:this.listMask.width();this.scrollButtonSize=0;this.scrollMid=0;this.mousePos=0;this.listPos=0;this.scrollInterval=0;this.shouldScroll=false;this.bottomPos=0;this.ratio=0;this.elements=[];this.listSize=0;this.scrollBar=c.find(e.ids.scrollBar).mediaslider(e.ids.scrollHandle,e.vertical);this.scrollWrapper=c.find(e.ids.scrollWrapper);this.scrollTrack=null;this.scrollUp=c.find(e.ids.scrollUp).medialink(e,function(){f.scroll(true);});this.scrollDown=c.find(e.ids.scrollDown).medialink(e,function(){f.scroll(false);});this.scrollButtonSize=e.vertical?this.scrollDown.display.outerHeight(true):this.scrollDown.display.outerWidth(true);if(this.scrollBar){if(e.showScrollbar){if(e.vertical){this.width+=this.scrollWrapper.width();}else{this.height+=this.scrollWrapper.height();}}else{this.scrollWrapper.width(0).hide();}this.scrollTrack=this.scrollBar.display.find(e.ids.scrollTrack);this.scrollBar.display.bind("updatevalue",function(g,h){f.setScrollPos(h*f.bottomPos,false);});this.scrollBar.display.bind("setvalue",function(g,h){f.setScrollPos(h*f.bottomPos,true);});}this.setScrollSize=function(g){if(g){this.scrollSize=g;this.listMask.css(e.vertical?"height":"width",this.scrollSize);this.scrollMid=this.scrollSize/2;var h=this.scrollSize-(e.hysteresis*2);this.bottomPos=(this.listSize-this.scrollSize);this.ratio=((this.listSize-h)/h);this.shouldScroll=(this.bottomPos>0);}};this.onResize=function(h,g){this.width+=h;this.height+=g;this.setScrollSize(e.vertical?(this.scrollSize+g):(this.scrollSize+h));if(this.scrollBar){var i=this.scrollSize-2*this.scrollButtonSize;if(e.vertical){this.scrollBar.display.css({height:i});this.scrollTrack.css({height:i});this.scrollBar.setSize(0,i);}else{this.scrollBar.display.css({width:i});this.scrollTrack.css({width:i});this.scrollBar.setSize(i,0);}}};this.clear=function(){this.mousePos=0;this.shouldScroll=false;this.bottomPos=0;this.ratio=0;this.scrolling=false;this.elements=[];this.listSize=0;this.list.css(this.margin,"0px");this.list.children().unbind();clearInterval(this.scrollInterval);this.list.empty();};this.getOffset=function(){return e.vertical?this.listMask.offset().top:this.listMask.offset().left;};this.activate=function(){this.setScrollSize(e.vertical?this.listMask.height():this.listMask.width());this.setScrollPos(0,true);};this.refresh=function(){this.setScrollSize(this.scrollSize);};this.newItem=function(){var h=a(this.template);this.list.append(h);var g=this.getElement(h,this.elements.length);this.listSize+=g.size;if(e.vertical){this.list.css({height:this.listSize,marginTop:this.listSize});}else{g.obj.css({"float":"left"});this.list.css({width:this.listSize});}this.elements.push(g);return g.obj;};this.getElement=function(i,g){var h=this.elementSize;var j=this.listSize;i.css({width:this.elementWidth,height:this.elementHeight});return{obj:i,size:h,position:j,bottom:(j+h),mid:(h/2),index:g};};this.scroll=function(g){var h=this.getElementAtPosition(g?0:this.scrollSize);if(h){var j=(h.straddle||g)?h:this.elements[h.index+1];if(j){var i=g?j.position:(j.bottom-this.scrollSize);this.setScrollPos(i,true);}}};this.onMouseMove=function(g){this.mousePos=g[this.pagePos]-this.getOffset();if(this.shouldScroll&&this.spanMode){this.setScrollPos((this.mousePos-e.hysteresis)*this.ratio);}};this.onMouseOver=function(g){if(this.shouldScroll){clearInterval(this.scrollInterval);this.scrollInterval=setInterval(function(){f.update();},e.updateTimeout);}};this.onMouseOut=function(g){clearInterval(this.scrollInterval);};this.align=function(g){var h=this.getElementAtPosition(g?0:this.scrollSize);if(h){var i=g?h.position:(h.bottom-this.scrollSize);this.setScrollPos(i,true);}};this.setVisible=function(g){var i=this.elements[g];if(i){var h=this.listPos;if(i.position<this.listPos){h=i.position;}else{if((i.bottom-this.listPos)>this.scrollSize){h=i.bottom-this.scrollSize;}}if(h!=this.listPos){this.setScrollPos(h,true);}}};this.getElementAtPosition=function(g){var j=null;var h=this.elements.length;while(h--){j=this.elements[h];if(((j.position-this.listPos)<g)&&((j.bottom-this.listPos)>=g)){j.straddle=((j.bottom-this.listPos)!=g);break;}}return j;};this.update=function(){var h=this.mousePos-this.scrollMid;if(Math.abs(h)>e.hysteresis){var g=(h>0)?-e.hysteresis:e.hysteresis;h=e.scrollSpeed*((this.mousePos+g-this.scrollMid)/this.scrollMid);this.setScrollPos(this.listPos+h);}};this.setScrollPos=function(h,g){h=(h<0)?0:h;if(this.shouldScroll&&(h>this.bottomPos)){h=this.bottomPos;}this.listPos=h;if(this.scrollBar){this.scrollBar.setPosition(this.listPos/this.bottomPos);}if(g){if(e.vertical){this.list.animate({marginTop:-this.listPos+"px"},(e.scrollSpeed*10));}else{this.list.animate({marginLeft:-this.listPos+"px"},(e.scrollSpeed*10));}}else{this.list.css(this.margin,-this.listPos+"px");}};})(this,b);};jQuery.media=jQuery.extend({},{sha256:function(){function b(T,S){b.charSize=8;b.b64pad="";b.hexCase=0;var Q=null;var H=null;var x=function(p){var o=[];var s=(1<<b.charSize)-1;var r=p.length*b.charSize;for(var q=0;q<r;q+=b.charSize){o[q>>5]|=(p.charCodeAt(q/b.charSize)&s)<<(32-b.charSize-q%32);}return o;};var n=function(p){var o=[];var s=p.length;for(var q=0;q<s;q+=2){var r=parseInt(p.substr(q,2),16);if(!isNaN(r)){o[q>>3]|=r<<(24-(4*(q%8)));}else{return"INVALID HEX STRING";}}return o;};var l=null;var j=null;if("HEX"===S){if(0!==(T.length%2)){return"TEXT MUST BE IN BYTE INCREMENTS";}l=T.length*4;j=n(T);}else{if(("ASCII"===S)||("undefined"===typeof(S))){l=T.length*b.charSize;j=x(T);}else{return"UNKNOWN TEXT INPUT TYPE";}}var R=function(p){var o=b.hexCase?"0123456789ABCDEF":"0123456789abcdef";var s="";var r=p.length*4;for(var q=0;q<r;q++){s+=o.charAt((p[q>>2]>>((3-q%4)*8+4))&15)+o.charAt((p[q>>2]>>((3-q%4)*8))&15);}return s;};var K=function(p){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var v="";var u=p.length*4;for(var r=0;r<u;r+=3){var s=(((p[r>>2]>>8*(3-r%4))&255)<<16)|(((p[r+1>>2]>>8*(3-(r+1)%4))&255)<<8)|((p[r+2>>2]>>8*(3-(r+2)%4))&255);for(var q=0;q<4;q++){if(r*8+q*6>p.length*32){v+=b.b64pad;}else{v+=o.charAt((s>>6*(3-q))&63);}}}return v;};var z=function(o,p){if(p<32){return(o>>>p)|(o<<(32-p));}else{return o;}};var y=function(o,p){if(p<32){return o>>>p;}else{return 0;}};var t=function(o,q,p){return(o&q)^(~o&p);};var m=function(o,q,p){return(o&q)^(o&p)^(q&p);};var k=function(o){return z(o,2)^z(o,13)^z(o,22);};var i=function(o){return z(o,6)^z(o,11)^z(o,25);};var h=function(o){return z(o,7)^z(o,18)^y(o,3);};var g=function(o){return z(o,17)^z(o,19)^y(o,10);};var f=function(p,r){var q=(p&65535)+(r&65535);var o=(p>>>16)+(r>>>16)+(q>>>16);return((o&65535)<<16)|(q&65535);};var e=function(p,o,u,s){var r=(p&65535)+(o&65535)+(u&65535)+(s&65535);var q=(p>>>16)+(o>>>16)+(u>>>16)+(s>>>16)+(r>>>16);return((q&65535)<<16)|(r&65535);};var d=function(p,o,v,u,s){var r=(p&65535)+(o&65535)+(v&65535)+(u&65535)+(s&65535);var q=(p>>>16)+(o>>>16)+(v>>>16)+(u>>>16)+(s>>>16)+(r>>>16);return((q&65535)<<16)|(r&65535);};var c=function(B,A,w){var o=[];var M,L,J,I,G,F,E,D;var v,s;var q;var p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(w==="SHA-224"){q=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];}else{q=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];}B[A>>5]|=128<<(24-A%32);B[((A+1+64>>9)<<4)+15]=A;var u=B.length;for(var C=0;C<u;C+=16){M=q[0];L=q[1];J=q[2];I=q[3];G=q[4];F=q[5];E=q[6];D=q[7];for(var r=0;r<64;r++){if(r<16){o[r]=B[r+C];}else{o[r]=e(g(o[r-2]),o[r-7],h(o[r-15]),o[r-16]);}v=d(D,i(G),t(G,F,E),p[r],o[r]);s=f(k(M),m(M,L,J));D=E;E=F;F=G;G=f(I,v);I=J;J=L;L=M;M=f(v,s);}q[0]=f(M,q[0]);q[1]=f(L,q[1]);q[2]=f(J,q[2]);q[3]=f(I,q[3]);q[4]=f(G,q[4]);q[5]=f(F,q[5]);q[6]=f(E,q[6]);q[7]=f(D,q[7]);}switch(w){case"SHA-224":return[q[0],q[1],q[2],q[3],q[4],q[5],q[6]];case"SHA-256":return q;default:return[];}};this.getHash=function(p,o){var r=null;var q=j.slice();switch(o){case"HEX":r=R;break;case"B64":r=K;break;default:return"FORMAT NOT RECOGNIZED";}switch(p){case"SHA-224":if(Q===null){Q=c(q,l,p);}return r(Q);case"SHA-256":if(H===null){H=c(q,l,p);}return r(H);default:return"HASH NOT RECOGNIZED";}};this.getHMAC=function(D,C,B,A){var w=null;var v=null;var u=[];var s=[];var q=null;var p=null;var o=null;switch(A){case"HEX":w=R;break;case"B64":w=K;break;default:return"FORMAT NOT RECOGNIZED";}switch(B){case"SHA-224":o=224;break;case"SHA-256":o=256;break;default:return"HASH NOT RECOGNIZED";}if("HEX"===C){if(0!==(D.length%2)){return"KEY MUST BE IN BYTE INCREMENTS";}v=n(D);p=D.length*4;}else{if("ASCII"===C){v=x(D);p=D.length*b.charSize;}else{return"UNKNOWN KEY INPUT TYPE";}}if(512<p){v=c(v,p,B);v[15]&=4294967040;}else{if(512>p){v[15]&=4294967040;}}for(var r=0;r<=15;r++){u[r]=v[r]^909522486;s[r]=v[r]^1549556828;}q=c(u.concat(j),512+l,B);q=c(s.concat(q),512+o,B);return(w(q));};}this.encrypt=function(e,c){var d=new b(c,"ASCII");return d.getHMAC(e,"ASCII","SHA-256","HEX");};}},jQuery.media);jQuery.fn.mediaslider=function(b,d,c){if(this.length===0){return null;}return new (function(h,e,g,f){var i=this;this.display=h.css({cursor:"pointer",position:"relative"});this.dragging=false;this.value=0;this.handle=this.display.find(e);this.pagePos=g?"pageY":"pageX";this.width=this.display.width();this.height=this.display.height();this.handleSize=g?this.handle.height():this.handle.width();this.handleOffset=g?this.handle.position().top:this.handle.position().left;this.handleMid=(this.handleSize/2);this.handlePoint=this.handleMid+this.handleOffset;this.handlePos=0;this.onResize=function(k,j){this.setSize(this.width+k,this.height+j);};this.setTrackSize=function(){this.trackSize=g?this.height:this.width;this.trackSize-=(this.handleOffset+this.handleSize);};this.setTrackSize();this.setSize=function(k,j){this.width=k?k:this.width;this.height=j?j:this.height;this.setTrackSize();this.updateValue(this.value);};this.setValue=function(j){this.setPosition(j);this.display.trigger("setvalue",this.value);};this.updateValue=function(j){this.setPosition(j);this.display.trigger("updatevalue",this.value);};this.setPosition=function(j){j=(j<0)?0:j;j=(j>1)?1:j;this.value=j;this.handlePos=f?(1-this.value):this.value;this.handlePos*=this.trackSize;if(g){this.handle.css("marginTop",this.handlePos+"px");}else{this.handle.css("marginLeft",this.handlePos+"px");}};this.display.bind("mousedown",function(j){j.preventDefault();i.dragging=true;});this.getOffset=function(){var j=g?this.display.offset().top:this.display.offset().left;return(j+(this.handleSize/2));};this.getPosition=function(j){var k=(j-this.getOffset())/this.trackSize;k=(k<0)?0:k;k=(k>1)?1:k;k=f?(1-k):k;return k;};this.display.bind("mousemove",function(j){j.preventDefault();if(i.dragging){i.updateValue(i.getPosition(j[i.pagePos]));}});this.display.bind("mouseleave",function(j){j.preventDefault();if(i.dragging){i.dragging=false;i.setValue(i.getPosition(j[i.pagePos]));}});this.display.bind("mouseup",function(j){j.preventDefault();if(i.dragging){i.dragging=false;i.setValue(i.getPosition(j[i.pagePos]));}});this.onResize(0,0);})(this,b,d,c);};jQuery.media.defaults=jQuery.extend(jQuery.media.defaults,{pageLink:false});jQuery.fn.mediateaser=function(d,b,e,c){if(this.length===0){return null;}return new (function(j,g,k,f,h){h=jQuery.media.utils.getSettings(h);var l=this;this.display=f;this.display.bind("mouseenter",function(m){if(h.template.onTeaserOver){h.template.onTeaserOver(l);}});this.display.bind("mouseleave",function(m){if(h.template.onTeaserOut){h.template.onTeaserOut(l);}});this.index=k;this.node=this.display.medianode(j,h);if(this.node){this.node.loadNode(g);}if(this.node&&h.pageLink){var i=h.baseURL;i+=g.path?g.path:("node/"+g.nid);this.node.display.wrap('<a href="'+i+'"></a>');}this.reset=function(){if(this.node){this.node.display.unbind();}};this.refresh=function(){if(this.node){this.node.onResize(0,0);}};this.setActive=function(m){if(h.template.onTeaserActivate){h.template.onTeaserActivate(this,m);}};this.setSelected=function(m){if(h.template.onTeaserSelect){h.template.onTeaserSelect(this,m);}};if(h.template.onTeaserLoad){h.template.onTeaserLoad(this);}})(d,b,e,this,c);};jQuery.media.ids=jQuery.extend(jQuery.media.ids,{titleLinks:"#mediatitlelinks"});jQuery.fn.mediatitlebar=function(b){if(this.length===0){return null;}return new (function(c,d){var e=this;this.display=c;this.titleLinks=this.display.find(d.ids.titleLinks);this.display.find("a").each(function(){var f=a(this).attr("href");a(this).medialink(d,function(g){g.preventDefault();e.display.trigger(g.data.id);},{id:f.substr(1),obj:a(this)});});})(this,b);};jQuery.media=jQuery.extend({},{utils:{getBaseURL:function(){var b=new RegExp(/^(http[s]?\:[\\\/][\\\/])([^\\\/\?]+)/);var c=b.exec(location.href);return c?c[0]:"";},getSettings:function(b){if(!b){b={};}if(!b.initialized){b=jQuery.extend({},jQuery.media.defaults,b);b.ids=jQuery.extend({},jQuery.media.ids,b.ids);b.baseURL=b.baseURL?b.baseURL:jQuery.media.utils.getBaseURL();b.baseURL+=b.baseURL?"/":"";b.initialized=true;}return b;},getId:function(b){return b.attr("id")?b.attr("id"):b.attr("class")?b.attr("class"):"mediaplayer";},getScaledRect:function(b,e){var d={};d.x=e.x?e.x:0;d.y=e.y?e.y:0;d.width=e.width?e.width:0;d.height=e.height?e.height:0;if(b){var c=(e.width/e.height);d.height=(c>b)?e.height:Math.floor(e.width/b);d.width=(c>b)?Math.floor(e.height*b):e.width;d.x=Math.floor((e.width-d.width)/2);d.y=Math.floor((e.height-d.height)/2);}return d;},checkVisibility:function(d,c){var b=true;d.parents().each(function(){var e=jQuery(this);if(!e.is(":visible")){b=false;var f=e.attr("class");c.push({obj:e,attr:f});e.removeClass(f);}});},resetVisibility:function(b){var c=b.length;while(c--){b[c].obj.addClass(b[c].attr);}},getFlash:function(i,b,c,j,e,d){var k=window.location.protocol;if(k.charAt(k.length-1)==":"){k=k.substring(0,k.length-1);}var g="";for(var h in e){if(e.hasOwnProperty(h)){g+=h+"="+encodeURIComponent(e[h])+"&";}}g=g.replace(/&$/,"");var f='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ';f+='codebase="'+k+'://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" ';f+='width="'+c+'" ';f+='height="'+j+'" ';f+='id="'+b+'" ';f+='name="'+b+'"> ';f+='<param name="allowScriptAccess" value="always"></param>';f+='<param name="allowfullscreen" value="true" />';f+='<param name="movie" value="'+i+'"></param>';f+='<param name="wmode" value="'+d+'"></param>';f+='<param name="quality" value="high"></param>';f+='<param name="FlashVars" value="'+g+'"></param>';f+='<embed src="'+i+'" quality="high" width="'+c+'" height="'+j+'" ';f+='id="'+b+'" name="'+b+'" swLiveConnect="true" allowScriptAccess="always" wmode="'+d+'"';f+='allowfullscreen="true" type="application/x-shockwave-flash" FlashVars="'+g+'" ';f+='pluginspage="'+k+'://www.macromedia.com/go/getflashplayer" />';f+="</object>";return f;},removeFlash:function(c,d){if(typeof(swfobject)!="undefined"){swfobject.removeSWF(d);}else{var b=c.find("object").eq(0)[0];if(b){b.parentNode.removeChild(b);}}},insertFlash:function(h,k,c,d,l,f,e,j){jQuery.media.utils.removeFlash(h,c);h.children().remove();h.append('<div id="'+c+'"><p><a href="http://www.adobe.com/go/getflashplayer"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" /></a></p></div>');if(typeof(swfobject)!="undefined"){var g={allowScriptAccess:"always",allowfullscreen:"true",wmode:e,quality:"high"};swfobject.embedSWF(k,c,d,l,"9.0.0","expressInstall.swf",f,g,{},function(m){j(m.ref);});}else{var i=jQuery.media.utils.getFlash(k,c,d,l,f,e);var b=h.find("#"+c).eq(0);if(jQuery.browser.msie){b[0].outerHTML=i;j(h.find("object").eq(0)[0]);}else{b.replaceWith(i);j(h.find("embed").eq(0)[0]);}}},cloneFix:function(e,d){var b=e.map(function(){var g=this.outerHTML;if(!g){var h=this.ownerDocument.createElement("div");h.appendChild(this.cloneNode(true));g=h.innerHTML;}return jQuery.clean([g.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/^\s*/,"")])[0];});if(d===true){var f=e.find("*").andSelf(),c=0;b.find("*").andSelf().each(function(){if(this.nodeName!==f[c].nodeName){return;}var g=jQuery.data(f[c],"events");for(var i in g){if(g.hasOwnProperty(i)){for(var h in g[i]){if(g[i].hasOwnProperty(h)){jQuery.event.add(this,i,g[i][h],g[i][h].data);}}}}c++;});}return b;}}},jQuery.media);window.onVimeoReady=function(b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onReady();};window.onVimeoFinish=function(b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onFinished();};window.onVimeoLoading=function(c,b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onLoading(c);};window.onVimeoPlay=function(b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onPlaying();};window.onVimeoPause=function(b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onPaused();};jQuery.media.playerTypes=jQuery.extend(jQuery.media.playerTypes,{vimeo:function(b){return(b.search(/^http(s)?\:\/\/(www\.)?vimeo\.com/i)===0);}});jQuery.fn.mediavimeo=function(c,b){return new (function(f,e,d){this.display=f;var g=this;this.player=null;this.videoFile=null;this.ready=false;this.bytesLoaded=0;this.bytesTotal=0;this.currentVolume=1;this.createMedia=function(j,l){this.videoFile=j;this.ready=false;var i=(e.id+"_media");var h={clip_id:this.getId(j.path),width:this.display.width(),height:this.display.height(),js_api:"1",js_onLoad:"onVimeoReady",js_swf_id:i};var k=Math.floor(Math.random()*1000000);var m="http://vimeo.com/moogaloop.swf?rand="+k;jQuery.media.utils.insertFlash(this.display,m,i,this.display.width(),this.display.height(),h,e.wmode,function(n){g.player=n;g.loadPlayer();});};this.getId=function(i){var h=/^http[s]?\:\/\/(www\.)?vimeo\.com\/([0-9]+)/i;return(i.search(h)==0)?i.replace(h,"$2"):i;};this.loadMedia=function(h){this.bytesLoaded=0;this.bytesTotal=0;this.createMedia(h);};this.onReady=function(){this.ready=true;this.loadPlayer();};this.loadPlayer=function(){if(this.ready&&this.player){this.player.api_addEventListener("onFinish","onVimeoFinish");this.player.api_addEventListener("onLoading","onVimeoLoading");this.player.api_addEventListener("onPlay","onVimeoPlay");this.player.api_addEventListener("onPause","onVimeoPause");d({type:"playerready"});this.playMedia();}};this.onFinished=function(){d({type:"complete"});};this.onLoading=function(h){this.bytesLoaded=h.bytesLoaded;this.bytesTotal=h.bytesTotal;};this.onPlaying=function(){d({type:"playing"});};this.onPaused=function(){d({type:"paused"});};this.playMedia=function(){d({type:"buffering"});this.player.api_play();};this.pauseMedia=function(){this.player.api_pause();};this.stopMedia=function(){this.pauseMedia();this.player.api_unload();};this.seekMedia=function(h){this.player.api_seekTo(h);};this.setVolume=function(h){this.currentVolume=h;this.player.api_setVolume((h*100));};this.getVolume=function(){return this.currentVolume;};this.getDuration=function(){return this.player.api_getDuration();};this.getCurrentTime=function(){return this.player.api_getCurrentTime();};this.getBytesLoaded=function(){return this.bytesLoaded;};this.getBytesTotal=function(){return this.bytesTotal;};this.setQuality=function(h){};this.getQuality=function(){return"";};this.hasControls=function(){return true;};this.showControls=function(h){};this.setSize=function(i,h){};this.getEmbedCode=function(){return"This video cannot be embedded.";};this.getMediaLink=function(){return"This video currently does not have a link.";};})(this,c,b);};jQuery.fn.mediavoter=function(b,d,c){if(this.length===0){return null;}return new (function(f,e,h,g){this.display=f;var i=this;this.nodeId=0;this.votes=[];this.tag=this.display.attr("tag");this.display.find("div").each(function(){if(g){a(this).css("cursor","pointer");a(this).bind("click",function(j){i.setVote(parseInt(a(this).attr("vote"),10));});a(this).bind("mouseenter",function(j){i.updateVote({value:parseInt(a(this).attr("vote"),10)},true);});}i.votes.push({vote:parseInt(a(this).attr("vote"),10),display:a(this)});});this.votes.sort(function(k,j){return(k.vote-j.vote);});if(g){this.display.bind("mouseleave",function(j){i.updateVote({value:0},true);});}this.updateVote=function(j,k){if(j&&e.template.updateVote){e.template.updateVote(this,j.value,k);}};this.getVote=function(k){if(k&&k.nid){this.nodeId=parseInt(k.nid,10);if(k.vote){var j=g?k.vote.uservote:k.vote.vote;this.updateVote(k.vote.vote,false);this.display.trigger("voteGet",j);}else{if(h&&k.nid&&(this.display.length>0)){this.display.trigger("processing");var l=g?jQuery.media.commands.getUserVote:jQuery.media.commands.getVote;h.call(l,function(m){i.updateVote(m,false);i.display.trigger("voteGet",m);},null,"node",this.nodeId,this.tag);}}}};this.setVote=function(j){if(h&&this.nodeId){this.display.trigger("processing");this.updateVote({value:j},false);h.call(jQuery.media.commands.setVote,function(k){i.display.trigger("voteSet",k);},null,"node",this.nodeId,j,this.tag);}};this.deleteVote=function(){if(h&&this.nodeId){this.display.trigger("processing");h.call(jQuery.media.commands.deleteVote,function(j){i.updateVote(j,false);i.display.trigger("voteDelete",j);},null,"node",this.nodeId,this.tag);}};})(this,b,d,c);};window.onYouTubePlayerReady=function(b){b=b.replace("_media","");jQuery.media.players[b].node.player.media.player.onReady();};jQuery.media.playerTypes=jQuery.extend(jQuery.media.playerTypes,{youtube:function(b){return(b.search(/^http(s)?\:\/\/(www\.)?youtube\.com/i)===0);}});jQuery.fn.mediayoutube=function(c,b){return new (function(f,e,d){this.display=f;var g=this;this.player=null;this.videoFile=null;this.loaded=false;this.ready=false;this.createMedia=function(i,k){this.videoFile=i;this.ready=false;var h=(e.id+"_media");var j=Math.floor(Math.random()*1000000);var l="http://www.youtube.com/apiplayer?rand="+j+"&amp;version=3&amp;enablejsapi=1&amp;playerapiid="+h;jQuery.media.utils.insertFlash(this.display,l,h,this.display.width(),this.display.height(),{},e.wmode,function(m){g.player=m;g.loadPlayer();});};this.getId=function(i){var h=/^http[s]?\:\/\/(www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9]+)/i;return(i.search(h)==0)?i.replace(h,"$2"):i;};this.loadMedia=function(h){if(this.player){this.loaded=false;this.videoFile=h;d({type:"playerready"});this.player.loadVideoById(this.getId(this.videoFile.path),0,e.quality);}};this.onReady=function(){this.ready=true;this.loadPlayer();};this.loadPlayer=function(){if(this.ready&&this.player){window[e.id+"StateChange"]=function(h){g.onStateChange(h);};window[e.id+"PlayerError"]=function(h){g.onError(h);};window[e.id+"QualityChange"]=function(h){g.quality=h;};this.player.addEventListener("onStateChange",e.id+"StateChange");this.player.addEventListener("onError",e.id+"PlayerError");this.player.addEventListener("onPlaybackQualityChange",e.id+"QualityChange");d({type:"playerready"});this.player.loadVideoById(this.getId(this.videoFile.path),0);}};this.onStateChange=function(i){var h=this.getPlayerState(i);d({type:h});if(!this.loaded&&h=="playing"){this.loaded=true;d({type:"meta"});}};this.onError=function(i){var h="An unknown error has occured: "+i;if(i==100){h="The requested video was not found.  ";h+="This occurs when a video has been removed (for any reason), ";h+="or it has been marked as private.";}else{if((i==101)||(i==150)){h="The video requested does not allow playback in an embedded player.";}}console.log(h);d({type:"error",data:h});};this.getPlayerState=function(h){switch(h){case 5:return"ready";case 3:return"buffering";case 2:return"paused";case 1:return"playing";case 0:return"complete";case -1:return"stopped";default:return"unknown";}return"unknown";};this.setSize=function(i,h){};this.playMedia=function(){d({type:"buffering"});this.player.playVideo();};this.pauseMedia=function(){this.player.pauseVideo();};this.stopMedia=function(){this.player.stopVideo();};this.seekMedia=function(h){d({type:"buffering"});this.player.seekTo(h,true);};this.setVolume=function(h){this.player.setVolume(h*100);};this.setQuality=function(h){this.player.setPlaybackQuality(h);};this.getVolume=function(){return(this.player.getVolume()/100);};this.getDuration=function(){return this.player.getDuration();};this.getCurrentTime=function(){return this.player.getCurrentTime();};this.getQuality=function(){return this.player.getPlaybackQuality();};this.getEmbedCode=function(){return this.player.getVideoEmbedCode();};this.getMediaLink=function(){return this.player.getVideoUrl();};this.getBytesLoaded=function(){return this.player.getVideoBytesLoaded();};this.getBytesTotal=function(){return this.player.getVideoBytesTotal();};this.hasControls=function(){return false;};this.showControls=function(h){};})(this,c,b);};})(jQuery);